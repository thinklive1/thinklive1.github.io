<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.css" integrity="sha256-vQkngPS8jiHHH0I6ABTZroZk8NPZ7b+MUReOFE9UsXQ=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"thinklive1.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#66CCFF","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":true,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="æå®æ¯…æœºå™¨å­¦ä¹  åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ">
<meta property="og:type" content="article">
<meta property="og:title" content="æœºå™¨å­¦ä¹ ç¬”è®° all in one">
<meta property="og:url" content="https://thinklive1.github.io/thinklive/48061/index.html">
<meta property="og:site_name" content="thinklive">
<meta property="og:description" content="æå®æ¯…æœºå™¨å­¦ä¹  åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250401210138.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250402152918.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250402152932.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/pk7amw95.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/o7aq5jae.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/output_8_0.svg">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csigma_x%5E2%3D%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi%3D1%7D%5En%5Cleft%28x_i-%5Cbar%7Bx%7D%5Cright%29%5E2&amp;consumer=ZHI_MENG">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Csigma%5Cleft%28x%2Cy%5Cright%29%3D%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%5Cleft%28x_i-%5Cbar%7Bx%7D%5Cright%29%5Cleft%28y_i-%5Cbar%7By%7D%5Cright%29&amp;consumer=ZHI_MENG">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250902150544.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250831171404.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/seq2seq_v9.png">
<meta property="og:image" content="https://thinklive1.github.io/assets/ml/seq2seq_v9_1.png">
<meta property="article:published_time" content="2025-09-09T07:53:29.840Z">
<meta property="article:modified_time" content="2025-09-09T07:53:29.840Z">
<meta property="article:author" content="thinklive">
<meta property="article:tag" content="è¯¾ç¨‹ç¬”è®°">
<meta property="article:tag" content="python">
<meta property="article:tag" content="äººå·¥æ™ºèƒ½">
<meta property="article:tag" content="å›½ç«‹å°æ¹¾å¤§å­¦">
<meta property="article:tag" content="æœºå™¨å­¦ä¹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://thinklive1.github.io/assets/ml/Pasted%20image%2020250401210138.png">


<link rel="canonical" href="https://thinklive1.github.io/thinklive/48061/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://thinklive1.github.io/thinklive/48061/","path":"thinklive/48061/","title":"æœºå™¨å­¦ä¹ ç¬”è®° all in one"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>æœºå™¨å­¦ä¹ ç¬”è®° all in one | thinklive</title>
  







<script type="text/javascript" async src="/js/fairyDustCursor.js"></script>
<script type="text/javascript" async src="/js/tab-title.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
  <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<script>
const options = {
  bottom: '64px', // default: '32px'
  right: 'unset', // default: '32px'
  left: '32px', // default: 'unset'
  time: '0.5s', // default: '0.3s'
  mixColor: '#fff', // default: '#fff'
  backgroundColor: '#fff',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: false, // default: true,
  label: 'ğŸŒ“', // default: ''
  autoMatchOsTheme: true // default: true
}

const darkmode = new Darkmode(options);
</script>
<!-- hexo injector head_end start --><script> let HEXO_MMEDIA_DATA = { js: [], css: [], aplayerData: [], metingData: [], artPlayerData: [], dplayerData: []}; </script><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="thinklive" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>
<script src="/js/tab-title.js"></script>
<script type="text/javascript" async src="/js/text.js"></script>

<!--pjaxï¼šé˜²æ­¢è·³è½¬é¡µé¢éŸ³ä¹æš‚åœ-->
 <script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script>
<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>
<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>


  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">thinklive</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">dirichlet library</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢ | search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-ä¸»é¡µ-|-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>ä¸»é¡µ | home</a></li><li class="menu-item menu-item-æ ‡ç­¾-|-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾ | tags</a></li><li class="menu-item menu-item-åˆ†ç±»-|-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±» | categories</a></li><li class="menu-item menu-item-å½’æ¡£-|-archive"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£ | archive</a></li><li class="menu-item menu-item-ç›¸å†Œ-|-photo"><a href="/photos/" rel="section"><i class="fa fa-camera fa-fw"></i>ç›¸å†Œ | photo</a></li><li class="menu-item menu-item-ç•™è¨€-|-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>ç•™è¨€ | guestbook</a></li><li class="menu-item menu-item-æ„Ÿè°¢-|-thank"><a href="/thanks/" rel="section"><i class="fa custom thanks fa-fw"></i>æ„Ÿè°¢ | thank</a></li><li class="menu-item menu-item-æ¸¸æˆ-|-game"><a href="/game/bad1.html" rel="section"><i class="fa fa-gamepad fa-fw"></i>æ¸¸æˆ | game</a></li><li class="menu-item menu-item-ç¥é¾›-|-shrine"><a href="/cyberblog/" rel="section"><i class="fa fa-microchip fa-fw"></i>ç¥é¾› | shrine</a></li><li class="menu-item menu-item-èµ„æºåœ°å›¾-|-resourcemap"><a href="/webstack/" rel="section"><i class="fa fa-list fa-fw"></i>èµ„æºåœ°å›¾ | resourcemap</a></li><li class="menu-item menu-item-æ€ç»´å¯¼å›¾-|-mindmap"><a href="/mindmap/index.html" rel="section"><i class="fa fa-map fa-fw"></i>æ€ç»´å¯¼å›¾ | mindmap</a></li><li class="menu-item menu-item-ç½‘ç«™åœ°å›¾-|-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>ç½‘ç«™åœ°å›¾ | sitemap</a></li><li class="menu-item menu-item-è’¸æ±½-|-steam"><a href="/steamgames/index.html" rel="section"><i class="fa fa custum steam fa-fw"></i>è’¸æ±½ | steam</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢ | search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">


<!--ç½‘æ˜“äº‘éŸ³ä¹æ’ä»¶-->
<!-- require APlayer -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<!-- require MetingJS-->
<script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script> 
<!--ç½‘æ˜“äº‘playlistå¤–é“¾åœ°å€-->   
<meting-js
    server="netease"
    type="playlist" 
    id="2762741085"
    mini="false"
    fixed="false"
    list-folded="true"
    autoplay="false"
    volume="0.2"
    theme="#4c4c4c"
    order="random"
    loop="all"
    preload="auto"
    lrc-type="2"
    mutex="true">
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E6%9C%9F%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.</span> <span class="nav-text">å‰æœŸå·¥ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6"><span class="nav-number">1.1.</span> <span class="nav-text">æ•°å­¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1"><span class="nav-number">1.1.1.</span> <span class="nav-text">ç»Ÿè®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E7%8E%87%E8%AE%BA"><span class="nav-number">1.1.2.</span> <span class="nav-text">æ¦‚ç‡è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%B8%83"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">åˆ†å¸ƒ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E8%AE%BA"><span class="nav-number">1.1.3.</span> <span class="nav-text">ä¿¡æ¯è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%86%B5"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">ç†µ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0"><span class="nav-number">1.1.4.</span> <span class="nav-text">çº¿æ€§ä»£æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8C%83%E6%95%B0"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">èŒƒæ•°</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7"><span class="nav-number">1.2.</span> <span class="nav-text">å·¥å…·</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cuda"><span class="nav-number">1.2.1.</span> <span class="nav-text">cuda</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.2.</span> <span class="nav-text">å®¹å™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python"><span class="nav-number">1.2.3.</span> <span class="nav-text">python</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%90%86%E8%AE%BA"><span class="nav-number">1.3.</span> <span class="nav-text">ç†è®º</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%A0%E9%87%8F"><span class="nav-number">1.3.1.</span> <span class="nav-text">å¼ é‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">1.3.2.</span> <span class="nav-text">ç¥ç»ç½‘ç»œçš„å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.3.</span> <span class="nav-text">å¸¸è§é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95-optimizer"><span class="nav-number">1.3.4.</span> <span class="nav-text">ä¼˜åŒ–ç®—æ³• optimizer</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96-normalization"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">å½’ä¸€åŒ– Normalization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">æ¢¯åº¦ä¸‹é™</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">åå‘ä¼ æ’­</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#momentum"><span class="nav-number">1.3.4.4.</span> <span class="nav-text">Momentum</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#adagrad"><span class="nav-number">1.3.4.5.</span> <span class="nav-text">AdaGrad</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E5%8C%96"><span class="nav-number">1.3.5.</span> <span class="nav-text">æ­£åˆ™åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%AD%E7%BB%83%E6%8A%80%E5%B7%A7"><span class="nav-number">1.3.6.</span> <span class="nav-text">è®­ç»ƒæŠ€å·§</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E6%9D%83%E5%80%BC"><span class="nav-number">1.3.6.1.</span> <span class="nav-text">åˆå§‹æƒå€¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#batch-normalization"><span class="nav-number">1.3.6.2.</span> <span class="nav-text">Batch Normalization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%91%E5%88%B6%E8%BF%87%E6%8B%9F%E5%90%88"><span class="nav-number">1.3.6.3.</span> <span class="nav-text">æŠ‘åˆ¶è¿‡æ‹Ÿåˆ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B6%85%E5%8F%82%E6%95%B0"><span class="nav-number">1.3.6.4.</span> <span class="nav-text">è¶…å‚æ•°</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.</span> <span class="nav-text">ç¥ç»ç½‘ç»œæ¨¡å‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#python-%E7%9B%B8%E5%85%B3"><span class="nav-number">2.1.</span> <span class="nav-text">python ç›¸å…³</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.1.1.</span> <span class="nav-text">åŸºç¡€è®­ç»ƒæ–¹æ³•ç¤ºä¾‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">çº¿æ€§æ¨¡å‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="nav-number">2.2.1.</span> <span class="nav-text">çº¿æ€§å›å½’</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#python%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">pythonå®ç°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">2.2.2.</span> <span class="nav-text">åˆ†ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%84%9F%E7%9F%A5%E6%9C%BA"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">æ„ŸçŸ¥æœº</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92discriminative-model"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">é€»è¾‘å›å½’(discriminative model)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%A6%82%E7%8E%87%E7%9A%84%E5%88%86%E7%B1%BB%E6%96%B9%E6%B3%95generative-model"><span class="nav-number">2.2.2.3.</span> <span class="nav-text">åŸºäºæ¦‚ç‡çš„åˆ†ç±»æ–¹æ³•(generative model)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#softmax"><span class="nav-number">2.2.2.4.</span> <span class="nav-text">softmax</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="nav-number">2.2.3.</span> <span class="nav-text">ä¼˜åŒ–æŠ€å·§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#normalization"><span class="nav-number">2.2.4.</span> <span class="nav-text">Normalization</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9Ccnn"><span class="nav-number">2.3.</span> <span class="nav-text">å·ç§¯ç¥ç»ç½‘ç»œCNN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#spatial-transformer-layer"><span class="nav-number">2.3.1.</span> <span class="nav-text">spatial transformer layer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#self-attention"><span class="nav-number">2.4.</span> <span class="nav-text">self-attention</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E5%BD%A2%E9%87%91%E5%88%9A"><span class="nav-number">2.4.1.</span> <span class="nav-text">å˜å½¢é‡‘åˆš</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bert"><span class="nav-number">2.4.2.</span> <span class="nav-text">bert</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rnn"><span class="nav-number">2.5.</span> <span class="nav-text">RNN</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#long-short-term-memory-lstm"><span class="nav-number">2.5.1.</span> <span class="nav-text">Long Short-term Memory (LSTM)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AE%E9%A2%98"><span class="nav-number">2.5.2.</span> <span class="nav-text">é—®é¢˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.6.</span> <span class="nav-text">æ·±åº¦å­¦ä¹ </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">2.6.1.</span> <span class="nav-text">æ¦‚å¿µ</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="thinklive"
      src="/images/thive.png">
  <p class="site-author-name" itemprop="name">thinklive</p>
  <div class="site-description" itemprop="description">èµ·åˆï¼Œä¸–ç•Œæ˜¯ä¸€å›¢æ€ç´¢ï¼Œå®ƒå‘æ‰€æœ‰çš„æ–¹å‘è¿ˆäº†ä¸€æ­¥ï¼Œäºæ˜¯ä¸‡ç‰©ç”±æ­¤è€Œç”Ÿ</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/thinklive1" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;thinklive1" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/t469631989@gmail.com" title="E-Mail â†’ t469631989@gmail.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/38099250?spm_id_from=333.1007.0.0" title="bilibili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;38099250?spm_id_from&#x3D;333.1007.0.0" rel="noopener me" target="_blank"><i class="fa custom bilibili fa-fw"></i>bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://steamcommunity.com/id/thinkliving" title="steam â†’ https:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;thinkliving" rel="noopener me" target="_blank"><i class="fa custom steam fa-fw"></i>steam</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS â†’ &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>

<div style="Text-align:center;width:100%"><div style="margin:0 auto"><canvas id="canvas" style="width:60%" height="100" width="700">å½“å‰æµè§ˆå™¨ä¸æ”¯æŒcanvasï¼Œè¯·æ›´æ¢æµè§ˆå™¨åå†è¯•</canvas></div><script>!function(){function t(t,e){for(var a=0;a<l[e].length;a++)for(var n=0;n<l[e][a].length;n++)1==l[e][a][n]&&(h.beginPath(),h.arc(14*(g+2)*t+2*n*(g+1)+(g+1),2*a*(g+1)+(g+1),g,0,2*Math.PI),h.closePath(),h.fill())}function e(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),a=[];a.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var r=c.length-1;r>=0;r--)a[r]!==c[r]&&t.push(r+"_"+(Number(c[r])+1)%10);for(var r=0;r<t.length;r++)n.apply(this,t[r].split("_"));c=a.concat()}function a(){for(var t=0;t<d.length;t++)d[t].stepY+=d[t].disY,d[t].x+=d[t].stepX,d[t].y+=d[t].stepY,(d[t].x>i+g||d[t].y>f+g)&&(d.splice(t,1),t--)}function n(t,e){for(var a=[1,2,3],n=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],r=0;r<l[e].length;r++)for(var o=0;o<l[e][r].length;o++)if(1==l[e][r][o]){var h={x:14*(g+2)*t+2*o*(g+1)+(g+1),y:2*r*(g+1)+(g+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*a[Math.floor(Math.random()*a.length)],color:n[Math.floor(Math.random()*n.length)],disY:1};d.push(h)}}function r(){o.height=100;for(var e=0;e<c.length;e++)t(e,c[e]);for(var e=0;e<d.length;e++)h.beginPath(),h.arc(d[e].x,d[e].y,g,0,2*Math.PI),h.fillStyle=d[e].color,h.closePath(),h.fill()}var l=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],o=document.getElementById("canvas");if(o.getContext){var h=o.getContext("2d"),f=100,i=700;o.height=f,o.width=i,h.fillStyle="#f00",h.fillRect(10,10,50,50);var c=[],d=[],g=o.height/20-1;!function(){var t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date);c.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6])}(),clearInterval(v);var v=setInterval(function(){e(),a(),r()},50)}}()</script></div>
<img class= 'logo' src="/images/thinklive_cyber.png"; z-index: '0'; style="max-width: 100%; width: auto; height: auto;background-color: --content-bg-color;">

        </div>
      </div>
    </div>

    
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://thinklive1.github.io/thinklive/48061/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/thive.png">
      <meta itemprop="name" content="thinklive">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="thinklive">
      <meta itemprop="description" content="èµ·åˆï¼Œä¸–ç•Œæ˜¯ä¸€å›¢æ€ç´¢ï¼Œå®ƒå‘æ‰€æœ‰çš„æ–¹å‘è¿ˆäº†ä¸€æ­¥ï¼Œäºæ˜¯ä¸‡ç‰©ç”±æ­¤è€Œç”Ÿ">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="æœºå™¨å­¦ä¹ ç¬”è®° all in one | thinklive">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          æœºå™¨å­¦ä¹ ç¬”è®° all in one
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-09-09 15:53:29" itemprop="dateCreated datePublished" datetime="2025-09-09T15:53:29+08:00">2025-09-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">è¯¾ç¨‹ç¬”è®°</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>16k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>57 åˆ†é’Ÿ</span>
    </span>
</div>

        
        </div>
      </header>
   

    
    
    
    <div class="post-body" itemprop="articleBody"><p><a target="_blank" rel="noopener" href="https://speech.ee.ntu.edu.tw/~hylee/ml/2022-spring.php">æå®æ¯…æœºå™¨å­¦ä¹ </a> <a target="_blank" rel="noopener" href="https://zh.d2l.ai/">åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ </a></p>
<span id="more"></span>
<h1 id="å‰æœŸå·¥ä½œ">å‰æœŸå·¥ä½œ</h1>
<h2 id="æ•°å­¦">æ•°å­¦</h2>
<h3 id="ç»Ÿè®¡">ç»Ÿè®¡</h3>
<p>æœºå™¨å­¦ä¹ çš„æœ¬è´¨æ˜¯å¯»æ‰¾ä¸€ä¸ªç†æƒ³çš„å‡½æ•°,è¿™ä¸ªç†æƒ³å¯ä»¥å®šä¹‰ä¸ºåœ¨è®­ç»ƒé›†å’Œå…¨é›†ä¸Šè¡¨ç°å‡ ä¹ä¸€è‡´,ä½¿ç”¨ç»Ÿè®¡çš„åŸç†å¯ä»¥å°½å¯èƒ½ç†è§£è¿™å…¶ä¸­çš„ä¸€äº›å…³ç³»:<br />
å®šä¹‰: <code>|ğ¿ â„, ğ’Ÿğ‘¡ğ‘Ÿğ‘ğ‘–ğ‘› âˆ’ ğ¿ â„, ğ’Ÿğ‘ğ‘™ğ‘™ | &gt; ğœ€</code>æ—¶<code>Dtrain</code>æ˜¯å·®çš„,é‚£ä¹ˆ:</p>
<p><span class="math display">\[P(\mathcal{D}_{t r a i n}\;i s\;b a d)\leq|\mathcal H|\cdot2e x p(-2N\varepsilon^{2})\]</span></p>
<p>å…¶ä¸­,Næ˜¯è®­ç»ƒæ ·æœ¬æ•°,Hä¸ºå¤‡é€‰å‡½æ•°çš„é›†åˆ,ä¹Ÿå°±æ˜¯å¦‚æœæƒ³è¦è¿™ä¸ªç†æƒ³æ¡ä»¶,Hå’ŒNä¼šå­˜åœ¨è¿™ç§çº¦æŸæ¡ä»¶<br />
éœ€è¦æ³¨æ„çš„æ˜¯,è¿™ä¸ªç†æƒ³æ¡ä»¶å¹¶ä¸åŒ…æ‹¬å…·ä½“çš„losså€¼,å¦‚æœHè¿‡å°,é‚£ä¹ˆlosså°±å¯èƒ½ä¼šå¾ˆå¤§</p>
<h3 id="æ¦‚ç‡è®º">æ¦‚ç‡è®º</h3>
<p>æ•°å­¦æœŸæœ›:</p>
<p><span class="math display">\[E[X]=\sum_{x}x P(X=x).\]</span></p>
<p>å½“å‡½æ•°f(x)çš„è¾“å…¥æ˜¯ä»åˆ†å¸ƒPä¸­æŠ½å–çš„éšæœºå˜é‡æ—¶,f(x)çš„æœŸæœ›å€¼ä¸º:</p>
<p><span class="math display">\[E_{x\sim P}[f(x)]=\sum_{x}f(x)P(x).\]</span></p>
<p>æ–¹å·®ï¼š</p>
<p><span class="math display">\[\operatorname{Var}[X]=E\left[(X-E[X])^{2}\right]=E[X^{2}]-E[X]^{2}.\]</span></p>
<h4 id="åˆ†å¸ƒ"><a target="_blank" rel="noopener" href="https://d2l.ai/chapter_appendix-mathematics-for-deep-learning/distributions.html">åˆ†å¸ƒ</a></h4>
<h3 id="ä¿¡æ¯è®º"><a target="_blank" rel="noopener" href="https://d2l.ai/chapter_appendix-mathematics-for-deep-learning/information-theory.html">ä¿¡æ¯è®º</a></h3>
<h4 id="ç†µ">ç†µ</h4>
<p>åœ¨ä¸åŒçš„é¢†åŸŸä¸­ï¼Œç†µè¢«è¡¨ç¤ºä¸ºæ··ä¹±ç¨‹åº¦ï¼Œä¸ç¡®å®šæ€§ï¼ŒæƒŠå¥‡ç¨‹åº¦ï¼Œä¸å¯é¢„æµ‹æ€§ï¼Œä¿¡æ¯é‡ç­‰ï¼Œä½†åœ¨æœºå™¨å­¦ä¹ ä¸­æˆ‘ä»¬åªéœ€è¦å¯¹ä¿¡æ¯è®ºä¸­çš„ç†µæœ‰åŸºæœ¬äº†è§£<br />
ä¿¡æ¯è®ºä¸­ç†µçš„æ¦‚å¿µé¦–æ¬¡è¢«é¦™å†œæå‡ºï¼Œç›®çš„æ˜¯å¯»æ‰¾ä¸€ç§é«˜æ•ˆ/æ— æŸåœ°ç¼–ç ä¿¡æ¯çš„æ–¹æ³•ï¼Œå³<strong>æ— æŸç¼–ç äº‹ä»¶ä¿¡æ¯çš„æœ€å°å¹³å‡ç¼–ç é•¿åº¦</strong> å³ä¿¡æ¯ç†µH(X) = -Î£ p(x) log2 p(x) (pä¸ºæ¦‚ç‡)</p>
<p>æ¥ä¸‹æ¥è¯´æ˜è¿™ä¸ªå…¬å¼ï¼Œå‡è®¾æˆ‘ä»¬ç”¨äºŒè¿›åˆ¶çš„å“ˆå¤«æ›¼ç¼–ç ï¼Œä¸€ä¸ªä¿¡æ¯å‡ºç°æ¦‚ç‡æ˜¯1/2,å³å…¶ä»–æ‰€æœ‰æƒ…å†µåŠ èµ·æ¥ä¹Ÿæ˜¯1/2ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°å…¶ç¼–ç é•¿åº¦å¿…ç„¶æ˜¯-log(1/2),ä¹Ÿå°±æ˜¯1ï¼Œæ°å¥½å’Œæˆ‘ä»¬çš„é¦™å†œç†µå®šä¹‰ä¸€è‡´äº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br />
ä¸¥è°¨çš„æ•°å­¦è¯æ˜è¶…å‡ºäº†csä¸“ä¸šèŒƒå›´ï¼Œè¿™é‡Œåªè¯´ä¸€ä¸‹ç›´è§‚ç†è§£ï¼Œç†µæœ‰ä¸¤ä¸ªæ€§è´¨ï¼š</p>
<ul>
<li>æ¦‚ç‡è¶Šå°ä¿¡æ¯é‡è¶Šå¤§(å¦‚æœä¸€ä¸ªå°æ¦‚ç‡äº‹ä»¶å‘ç”Ÿäº†ï¼Œå°±æ’é™¤äº†éå¸¸å¤šå…¶ä»–å¯èƒ½æ€§)</li>
<li>å‡è®¾ä¸¤ä¸ªéšæœºå˜é‡x,yç›¸äº’ç‹¬ç«‹ï¼Œé‚£ä¹ˆåˆ†åˆ«è§‚æµ‹ä¸¤ä¸ªå˜é‡å¾—åˆ°çš„ä¿¡æ¯é‡åº”è¯¥å’ŒåŒæ—¶è§‚æµ‹ä¸¤ä¸ªå˜é‡çš„ä¿¡æ¯é‡æ˜¯ç›¸åŒçš„ï¼Œ<code>h(x+y)=h(x)+h(y)</code></li>
</ul>
<p>å¦‚æ­¤ä¸€æ¥å¯¹æ•°å‡½æ•°çš„è´Ÿæ•°å®Œç¾ç¬¦åˆæ¡ä»¶ï¼ŒåŸºæ•°åˆ™æ— æ‰€è°“ï¼Œç›´è§‚åœ°ç†è§£ï¼ŒåŸºæ•°å¯¹åº”ç”¨å‡ è¿›åˆ¶ç¼–ç ï¼Œè€Œè¦æœ€çŸ­åŒ–ç¼–ç ï¼Œè¶Šå°æ¦‚ç‡å°±åº”è¯¥ç”¨æ›´é•¿çš„ä½æ•°ï¼ŒæŠŠçŸ­ä½æ•°è…¾å‡ºæ¥ç»™å¤§æ¦‚ç‡äº‹ä»¶ç”¨ï¼Œå½“ç„¶å®é™…ä¸­ç¼–ç çš„ä½æ•°æ˜¯ç¦»æ•£çš„ï¼Œè€Œä¸”ç›¸æ¯”å¯¹æ•°å–è´Ÿåªèƒ½å¤šä¸èƒ½å°‘ï¼Œå› æ­¤é¦™å†œç†µæ˜¯ä¸€ä¸ªç†è®ºæœ€ä¼˜å€¼ï¼Œç†µç¼–ç å°±æŒ‡æ— æŸæƒ…å†µä¸‹çš„ç¼–ç æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯å“ˆå¤«æ›¼ç¼–ç ï¼Œæ‰€æœ‰ç†µç¼–ç æ–¹å¼çš„ç¼–ç é•¿åº¦å¤§äºç­‰äºé¦™å†œç†µ</p>
<p>ç°å®ä¸­å¸¸ç”¨äºŒè¿›åˆ¶ç¼–ç ä¿¡æ¯ï¼Œä¾‹å¦‚å¯¹8ç§ä¸åŒçš„ä¿¡æ¯ï¼Œæœ€ç›´è§‚çš„ç¼–ç æ˜¯ä¸‰ä½äºŒè¿›åˆ¶ï¼Œæ¯ä¸‰ä½è¡¨ç¤ºä¸€ä¸ªç‹¬ç‰¹ä¿¡æ¯ã€‚<br />
æˆ‘ä»¬å¯ä»¥ç”¨æ¦‚ç‡è¡¨ç¤ºæ¯ç§ä¿¡æ¯å‡ºç°çš„å¯èƒ½ï¼Œä¾‹å¦‚8ç§ä¿¡æ¯ï¼Œæ¯ä¸ªéƒ½ç­‰å¯èƒ½å‡ºç°ï¼Œé‚£ä¹ˆä»¥æ¦‚ç‡ä¸ºæƒçš„å“ˆå¤«æ›¼ç¼–ç å°±ä¼šç”¨æ‰€æœ‰çš„3ä½äºŒè¿›åˆ¶ç¼–ç è¿™8ç§ä¿¡æ¯ï¼Œç†µå°±æ˜¯3ï¼Œè€Œå…¶ä»–æƒ…å†µç†µå¯ä»¥å½“åšå“ˆå¤«æ›¼æ ‘çš„æ€»ç¼–ç é•¿åº¦ç®—<br />
é‚£ä¹ˆå¦‚ä½•ç†è§£ç†µèƒ½åæ˜ æ··ä¹±åº¦å‘¢ï¼Ÿå¦‚æœç†µæ¯”è¾ƒå¤§(å³å¹³å‡ç¼–ç é•¿åº¦è¾ƒé•¿)ï¼Œæ„å‘³ç€è¿™ä¸€ä¿¡æ¯æœ‰è¾ƒå¤šçš„å¯èƒ½çŠ¶æ€ï¼Œç›¸åº”çš„æ¯ä¸ªçŠ¶æ€çš„å¯èƒ½æ€§æ¯”è¾ƒä½ï¼›å› æ­¤æ¯å½“æ¥äº†ä¸€ä¸ªæ–°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¾ˆéš¾å¯¹å…¶ä½œå‡ºå‡†ç¡®é¢„æµ‹ï¼Œå³æœ‰ç€æ¯”è¾ƒå¤§çš„æ··ä¹±ç¨‹åº¦/ä¸ç¡®å®šæ€§/ä¸å¯é¢„æµ‹æ€§</p>
<p><strong>äº¤å‰ç†µ</strong>ï¼š<br />
äº¤å‰ç†µç”¨äºè¯„ä¼°ä¼°è®¡æ¦‚ç‡å¾—åˆ°çš„ç†µä¸çœŸå®ç†µçš„å·®è·ï¼Œäº¤å‰çš„å«ä¹‰å¾ˆç›´è§‚ï¼Œå°±æ˜¯ä½¿ç”¨Pè®¡ç®—æœŸæœ›ï¼Œä½¿ç”¨Qè®¡ç®—ç¼–ç é•¿åº¦<br />
ä¸ºä»€ä¹ˆè¿™ä¹ˆé€‰è€Œä¸æ˜¯åè¿‡æ¥å‘¢ï¼Ÿè¿™å–å†³äºæˆ‘ä»¬çš„ç›®çš„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›ä¼°è®¡çš„ç¼–ç é•¿åº¦å’Œç†è®ºæœ€ä¼˜çš„ç†µå·®è·è¾ƒå°ï¼Œè¦æ¯”å¯¹å–ä¼˜çš„ä¸»è¦æ˜¯æ¨¡å‹çš„ç¼–ç é•¿åº¦å³logQï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼Œç†µå…¬å¼ä¸­çš„å¯¹æ•°å‡½æ•°è§†ä¸ºè§†ä¸ºå¯¹ä¸€ä¸ªç‰¹å®šæ¦‚ç‡äº‹ä»¶çš„ç¼–ç é•¿åº¦ï¼Œç”±äºç°å®çš„æ¦‚ç‡åˆ†å¸ƒå®é™…ä¸Šæ˜¯ç¡®å®šçš„ï¼Œé‚£ä¹ˆéœ€è¦è¯„ä¼°çš„ä¹Ÿå°±æ˜¯ç¼–ç æ–¹å¼çš„æ•ˆç‡<br />
ç”±äºç†µæ˜¯ç»™å®šæ¦‚ç‡åˆ†å¸ƒä¸‹çš„æœ€ä¼˜å€¼ï¼Œ<strong>äº¤å‰ç†µåªå¯èƒ½å¤§äºç­‰äºç†µ</strong>ï¼Œä¸¤è€…å·®è¶Šå°æˆ–è€…è¯´äº¤å‰ç†µè¶Šå°è¡¨ç¤ºæ¨¡å‹ä¼°è®¡è¶Šå‡†<br />
ä¾‹å¦‚åœ¨æœ€æç«¯çš„one-hotç¼–ç ä¸­ï¼Œäº¤å‰ç†µç­‰ä»·äº<strong>å¯¹åº”æ­£ç¡®è§£æ ‡ç­¾çš„è¾“å‡ºçš„è‡ªç„¶å¯¹æ•°</strong></p>
<h3 id="çº¿æ€§ä»£æ•°">çº¿æ€§ä»£æ•°</h3>
<h4 id="èŒƒæ•°">èŒƒæ•°</h4>
<p>èŒƒæ•°æ˜¯å…·æœ‰â€œé•¿åº¦â€æ¦‚å¿µçš„å‡½æ•°ï¼Œç”¨äºè¡¡é‡ä¸€ä¸ªçŸ¢é‡çš„å¤§å°ï¼ˆæµ‹é‡çŸ¢é‡çš„æµ‹åº¦ï¼‰<br />
ç”±äºä¸æ˜¯æ•°å­¦ç³»çš„ï¼Œè¿™é‡Œå°±æä¸ºä¸ä¸¥è°¨åœ°è®°å½•ä¸€ä¸‹èŒƒæ•°çš„ç†è§£ï¼š</p>
<ul>
<li>0èŒƒæ•°ï¼Œå‘é‡ä¸­éé›¶å…ƒç´ çš„ä¸ªæ•°</li>
<li>1èŒƒæ•°ï¼Œä¸ºç»å¯¹å€¼ä¹‹å’Œ</li>
<li>2èŒƒæ•°ï¼Œå°±æ˜¯é€šå¸¸æ„ä¹‰ä¸Šçš„æ¨¡</li>
</ul>
<p>æ­£åˆ™åŒ–çš„ç›®çš„å¯ä»¥ç†è§£ä¸ºé™åˆ¶æƒé‡å‘é‡çš„å¤æ‚åº¦ï¼Œå®é™…åšæ³•ä¸ºåœ¨æŸå¤±å‡½æ•°ä¸­åŠ å…¥ä¸æƒé‡å‘é‡å¤æ‚åº¦æœ‰å…³çš„æƒ©ç½šé¡¹ï¼Œè€ŒèŒƒæ•°åœ¨æŸç§æ„ä¹‰ä¸Šå¯ä»¥åæ˜ è¿™ç‚¹ï¼Œå› æ­¤å¯ä½œä¸ºé€‰å–æ­£åˆ™é¡¹çš„ä¾æ®<br />
é¡ºä¾¿ä¸€æa starç®—æ³•ä¹Ÿä¼šç”¨ç±»ä¼¼çš„æµ‹åº¦ä¼°è®¡è·ç¦»</p>
<h2 id="å·¥å…·">å·¥å…·</h2>
<h3 id="cuda">cuda</h3>
<p>Compute Unified Device Architecture (CUDA):ç®€å•åœ°è¯´ï¼Œå°±æ˜¯å…è®¸è½¯ä»¶è°ƒç”¨gpuæ¥è®¡ç®—çš„ä¸€ä¸ªæ¥å£<br />
CUDA Runtime API vs. CUDA Driver API</p>
<ul>
<li>é©±åŠ¨ç‰ˆæœ¬éœ€è¦â‰¥è¿è¡Œæ—¶apiç‰ˆæœ¬</li>
<li>driver user-space moduleséœ€è¦å’Œdriver kernel modulesç‰ˆæœ¬ä¸€è‡´</li>
<li>å½“æˆ‘ä»¬è°ˆè®ºcudaæ—¶ï¼Œå¾€å¾€æ˜¯è¯´runtime api</li>
</ul>
<p>ä»¥ä¸‹æ˜¯nvidaçš„ä»‹ç»åŸæ–‡ï¼š</p>
<div class="note default"><p>It is composed of two APIs:</p>
<ul>
<li>A low-level API called the CUDA driver API,</li>
<li>A higher-level API called the CUDA runtime API that is implemented on top of the CUDA driver API.</li>
</ul>
<p>The CUDA runtime eases device code management by providing implicit initialization, context management, and module management. The C host code generated by nvcc is based on the CUDA runtime (see Section 4.2.5), so applications that link to this code must use the CUDA runtime API.</p>
<p>In contrast, the CUDA driver API requires more code, is harder to program and debug, but offers a better level of control and is language-independent since it only deals with cubin objects (see Section 4.2.5). In particular, it is more difficult to configure and launch kernels using the CUDA driver API, since the execution configuration and kernel parameters must be specified with explicit function calls instead of the execution configuration syntax described in Section 4.2.3. Also, device emulation (see Section 4.5.2.9) does not work with the CUDA driver API.</p>
</div>
<p>ç®€å•åœ°è¯´,driveræ›´åº•å±‚ï¼Œæ›´æŠ½è±¡ä½†æ€§èƒ½å’Œè‡ªç”±åº¦æ›´å¥½ï¼Œruntimeåˆ™ç›¸å</p>
<h3 id="å®¹å™¨">å®¹å™¨</h3>
<p><img src="/assets/ml/Pasted%20image%2020250401210138.png" /><br />
infrastructure(åŸºç¡€è®¾æ–½)<br />
ç®€å•åœ°è¯´ï¼Œè™šæ‹Ÿæœºçš„éš”ç¦»çº§åˆ«æ¯”å®¹å™¨æ›´é«˜ï¼Œè™šæ‹Ÿæœºä¼šæ¨¡æ‹Ÿå‡ºä¸€ä¸ªç³»ç»ŸåŠå…¶ç³»ç»Ÿapiï¼Œè€Œdockerä¾æ—§è°ƒç”¨å®¿ä¸»æœºçš„apiï¼Œå› æ­¤dockeræ›´ä¸ºè½»é‡çº§<br />
dockeræ˜¯å¤„ç†å¤æ‚ç¯å¢ƒé—®é¢˜çš„è‰¯ç­–ï¼Œæ¯”è™šæ‹Ÿæœºæ›´ä¸ºè½»é‡<br />
å…¶ä»–å¸¸ç”¨çš„å®¹å™¨:Slurm and Kubernetes</p>
<p><a target="_blank" rel="noopener" href="https://hub.docker.com/r/pytorch/pytorch/tags">Docker Hub repository of PyTorch</a></p>
<h3 id="python">python</h3>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt  </span><br><span class="line"><span class="comment"># ç”Ÿæˆæ•°æ®  x = np.arange(0, 6, 0.1) # ä»¥ 0.1 ä¸ºå•ä½,ç”Ÿæˆ 0 åˆ° 6 çš„æ•°æ® </span></span><br><span class="line"></span><br><span class="line">y1 = np.sin(x)</span><br><span class="line">y2 = np.cos(x)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶å›¾å½¢  </span></span><br><span class="line">plt.plot(x, y1, label=<span class="string">&quot;sin&quot;</span>) plt.plot(x, y2, linestyle = <span class="string">&quot;--&quot;</span>, label=<span class="string">&quot;cos&quot;</span>) </span><br><span class="line"><span class="comment"># ç”¨è™šçº¿ç»˜åˆ¶ </span></span><br><span class="line">plt.xlabel(<span class="string">&quot;x&quot;</span>) </span><br><span class="line"><span class="comment"># x è½´æ ‡ç­¾ </span></span><br><span class="line">plt.ylabel(<span class="string">&quot;y&quot;</span>) </span><br><span class="line"><span class="comment"># y è½´æ ‡ç­¾ </span></span><br><span class="line">plt.title(<span class="string">&#x27;sin &amp; cos&#x27;</span>) </span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ç†è®º">ç†è®º</h2>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/tensors.html">å®˜æ–¹æ–‡æ¡£</a><br />
<a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/index.html">Official Pytorch Tutorials</a><br />
<a target="_blank" rel="noopener" href="https://github.com/wkentaro/pytorch-for-numpy-users">pytorch-for-numpy-users</a></p>
<h3 id="å¼ é‡">å¼ é‡</h3>
<p><strong>å¼ é‡tensor</strong>:ç”¨äºè¡¨ç¤ºnç»´æ•°æ®çš„ä¸€ç§æ¦‚å¿µï¼Œä¾‹å¦‚ä¸€ç»´å¼ é‡æ˜¯å‘é‡ï¼ŒäºŒç»´æ˜¯çŸ©é˜µâ€¦â€¦</p>
<p><code>dim in PyTorch == axis in NumPy</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>, torch.cuda.is_available())</span><br><span class="line">    <span class="keyword">if</span> torch.cuda.is_available():</span><br><span class="line">        device = torch.device(<span class="string">&quot;cuda&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;There are <span class="subst">&#123;torch.cuda.device_count()&#125;</span> GPU(s) available.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Device name:&quot;</span>, torch.cuda.get_device_name(<span class="number">0</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No GPU available, using the CPU instead.&quot;</span>)</span><br><span class="line">        device = torch.device(<span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<pre><code> True
There are 1 GPU(s) available.
Device name: NVIDIA GeForce RTX 2070</code></pre>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›æœ´ç´ çš„å¼ é‡æ“ä½œ:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = torch.tensor([[<span class="number">1</span>, -<span class="number">1</span>], [-<span class="number">1</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">x = torch.from_numpy(np.array([[<span class="number">1</span>, -<span class="number">1</span>], [-<span class="number">1</span>, <span class="number">1</span>]]))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>
<pre><code>tensor([[ 1, -1],
        [-1,  1]])
tensor([[ 1, -1],
        [-1,  1]])</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = torch.zeros([<span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">x = torch.ones([<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>]) </span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>
<pre><code>tensor([[0., 0.],
        [0., 0.]])
tensor([[[1., 1., 1., 1., 1.],
         [1., 1., 1., 1., 1.]]])</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = torch.zeros([<span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(x.shape)</span><br><span class="line"></span><br><span class="line">x = x.transpose(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(x.shape)</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([2, 3])  
torch.Size([3, 2])</code></pre>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">A = torch.arange(<span class="number">20</span>, dtype=torch.float32).reshape(<span class="number">5</span>, <span class="number">4</span>) </span><br><span class="line">B = A.clone() <span class="comment"># é€šè¿‡åˆ†é…æ–°å†…å­˜,å°†Açš„ä¸€ä¸ªå‰¯æœ¬åˆ†é…ç»™B  </span></span><br><span class="line"></span><br><span class="line">A*B<span class="comment">#æŒ‰å…ƒç´ ä¹˜æ³•çš„Hadamardç§¯ï¼Œå³çŸ©é˜µç›¸åŒä½ç½®çš„å…ƒç´ ç›¸ä¹˜ï¼Œå¾—åˆ°ç»“æœçŸ©é˜µè¯¥ä½ç½®çš„å…ƒç´ ï¼Œæ•°å­¦ç¬¦å·âŠ™</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ç»“æœå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">tensor([[ 0., 1., 4., 9.], </span></span><br><span class="line"><span class="string">        [ 16., 25., 36., 49.], </span></span><br><span class="line"><span class="string">        [ 64., 81., 100., 121.],</span></span><br><span class="line"><span class="string">        [144., 169., 196., 225.],</span></span><br><span class="line"><span class="string">        [256., 289., 324., 361.]])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">A_sum_axis0 = A.<span class="built_in">sum</span>(axis=<span class="number">0</span>)  <span class="comment">#æ²¿0è½´å¯¹Aæ±‚å’Œ</span></span><br><span class="line">A_sum_axis0, A_sum_axis0.shape</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">numpyçš„å¯¹æŸä¸€è½´æ±‚å’Œï¼Œå°±æ˜¯æŠŠè¾“å…¥è½´æ‰€æœ‰å€¼åŠ èµ·æ¥ï¼ŒæŠ•å½±åˆ°å‰©ä¸‹çš„è½´ä¸Šï¼Œè¿™ä¸ªè½´ä¸æ˜¯æ¶ˆå¤±äº†ï¼Œè€Œæ˜¯ç°åœ¨è¢«æŠ•å½±åˆ°ä¸€èµ·ï¼Œä¾‹å¦‚äºŒç»´çŸ©é˜µé‡Œï¼Œæ²¿0è½´æ±‚å’Œï¼Œå°±æ˜¯æ²¿ç€æ‰€æœ‰è¡Œæ±‚å’Œï¼Œæ‰€æœ‰è¡Œçš„å¯¹åº”å…ƒç´ åŠ èµ·æ¥ï¼ŒæŠ•å½±åˆ°ä¸€è¡Œï¼Œç»“æœè¡Œæ•°ä¸º1å¯ä»¥é™ä½ä¸€ä¸ªç»´åº¦ä¸ºå‘é‡ï¼Œä½œä¸ºsumçš„è¾“å‡º(æ›´é«˜ç»´æƒ…å†µä¸‹é™¤äº†è¾“å…¥è½´éƒ½ä¸å˜ï¼Œæœ€åç»´åº¦-1)</span></span><br><span class="line"><span class="string">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç»“æœæ˜¯ï¼š</span></span><br><span class="line"><span class="string">(tensor([40., 45., 50., 55.]), torch.Size([4]))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚æœè®©sumçš„å‚æ•°keepdims=Trueï¼Œå°±ä¸ä¼šæ‰§è¡Œç»´åº¦å‡ä¸€çš„æ“ä½œï¼Œç»“æœä¼šæ˜¯ä¸ªè¡Œæ•°1ï¼Œåˆ—æ•°4çš„çŸ©é˜µ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ²¿æŸä¸ªè½´è®¡ç®—Aå…ƒç´ çš„ç´¯ç§¯æ€»å’Œ,æ¯”å¦‚<code>axis=0(æŒ‰è¡Œè®¡ç®—)</code>,å¯ä»¥è°ƒç”¨<code>cumsum</code>å‡½æ•°ã€‚æ­¤å‡½æ•°ä¸ä¼šæ²¿ä»»ä½•è½´é™ä½è¾“å…¥å¼ é‡çš„ç»´åº¦ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">A.cumsum(axis=<span class="number">0</span>)  </span><br><span class="line">tensor([[ <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>],  </span><br><span class="line">        [ <span class="number">4.</span>, <span class="number">6.</span>, <span class="number">8.</span>, <span class="number">10.</span>],  </span><br><span class="line">        [<span class="number">12.</span>, <span class="number">15.</span>, <span class="number">18.</span>, <span class="number">21.</span>],  </span><br><span class="line">        [<span class="number">24.</span>, <span class="number">28.</span>, <span class="number">32.</span>, <span class="number">36.</span>],  </span><br><span class="line">        [<span class="number">40.</span>, <span class="number">45.</span>, <span class="number">50.</span>, <span class="number">55.</span>]])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ç¥ç»ç½‘ç»œçš„å®šä¹‰">ç¥ç»ç½‘ç»œçš„å®šä¹‰</h3>
<p>å¯¹æ¯ä¸€å±‚ç¥ç»ç½‘ç»œï¼Œè¾“å…¥çš„xä¹˜ä»¥æƒé‡å‘é‡w(eight)ï¼ŒåŠ ä¸Šä¸€ä¸ªæ ‡é‡b(ias)åå°±æ˜¯è¾“å‡ºy<br />
ä¾‹å¦‚è®­ç»ƒä¸€ä¸ªå°†32ç»´å‘é‡è½¬åŒ–ä¸º64ç»´å‘é‡è¾“å‡ºçš„æ¨¡å‹ï¼Œæƒå€¼çŸ©é˜µè§„æ¨¡æ˜¯64Ã—32,è¾“å…¥å‘é‡æ˜¯32Ã—1ï¼Œè¾“å‡ºæ˜¯64Ã—1<br />
ç®—å‡ºçº¿æ€§çš„æƒå€¼å’Œä¹‹åï¼Œå¢åŠ ä¸€å±‚æ¿€æ´»å‡½æ•°<strong>Activation Function</strong>,æ¿€æ´»å‡½æ•°å¸¸æ˜¯éçº¿æ€§çš„ï¼Œç”¨äºå¢å¼ºç½‘ç»œå­¦ä¹ èƒ½åŠ›ï¼Œå¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œç½‘ç»œå°±æ˜¯å•çº¯çš„æœ‰å¾ˆå¤šå±‚æ•°çš„çº¿æ€§å›å½’<br />
æœ€åŸºç¡€çš„ç¥ç»ç½‘ç»œæ˜¯<strong>å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œ(fully-connected feed-forward network)</strong>:å‰é¦ˆè¡¨ç¤ºä»å‰åˆ°åè®­ç»ƒï¼Œå…¨è¿æ¥è¡¨ç¤ºç›¸é‚»çš„ä¸¤å±‚ä¸­ï¼Œæ‰€æœ‰çš„ç¥ç»å…ƒéƒ½æ˜¯ç›¸è¿çš„;ç½‘ç»œç¬¬ä¸€å±‚ç§°ä¸ºè¾“å…¥å±‚ï¼ˆinput layerï¼‰ï¼Œæœ€åä¸€å±‚ç§°ä¸ºè¾“å‡ºå±‚ï¼ˆoutput layerï¼‰ï¼Œä¸­é—´çš„å±‚æ•°è¢«ç§°ä¸ºéšè—å±‚(hidden layer)</p>
<div class="note info"><p><em>å‰å‘å’Œåå‘ï¼Œforward &amp;&amp; backward:ç†è§£è¿™ä¸¤ä¸ªè¯åº”è¯¥çœ‹è‹±æ–‡ï¼Œforwardè¿™ä¸ªå‰æŒ‡çš„æ˜¯æ—¶é—´ä¸Šä»å‰å¾€åï¼Œä¹Ÿå°±æ˜¯è®­ç»ƒæ—¶çš„æ­£å¸¸æ—¶é—´é¡ºåºï¼Œbackwardä¸å…¶ç›¸åï¼Œå°±æ˜¯ä»ç»“æœæ¨å¼€å¤´</em></p>
</div>
<p>æ·±åº¦å­¦ä¹ ï¼šè¿™ä¸ªå®šä¹‰éå¸¸ç®€å•ç²—æš´ï¼Œæ„æ€æ˜¯éšè—å±‚å¾ˆå¤šï¼Œä¸€èˆ¬å¯èƒ½æœ‰ä¸‰ä½æ•°èµ·æ­¥ï¼Œå¹¶éè¶Šå¤šå±‚å°±è¶Šå¥½ï¼Œè¿™éœ€è¦åˆé€‚çš„æ•°æ®é›†ï¼Œåˆé€‚çš„æå–ç‰¹å¾æ–¹å¼ï¼Œå³<strong>ç‰¹å¾å·¥ç¨‹feature engineering</strong>ï¼Œæ‰èƒ½å®šä¹‰ä¸€ä¸ªè¾ƒå¥½çš„ç½‘ç»œ</p>
<p>å¸¸è§æ¿€æ´»å‡½æ•°ï¼š</p>
<ul>
<li>Sigmoidå‡½æ•°ä¹Ÿå«Logisticå‡½æ•°ï¼Œç”¨äºéšå±‚ç¥ç»å…ƒè¾“å‡ºï¼Œå–å€¼èŒƒå›´ä¸º(0,1)ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªå®æ•°æ˜ å°„åˆ°(0,1)çš„åŒºé—´ï¼Œå¯ä»¥ç”¨æ¥åšäºŒåˆ†ç±»ã€‚åœ¨ç‰¹å¾ç›¸å·®æ¯”è¾ƒå¤æ‚æˆ–æ˜¯ç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§æ—¶æ•ˆæœæ¯”è¾ƒå¥½ï¼Œå›¾åƒç±»ä¼¼ä¸€ä¸ªSå½¢æ›²çº¿:
<ul>
<li> $ f(x)=\frac{1}{1+e^{-x}} $  </li>
</ul></li>
<li>ReLUå‡½æ•°åˆç§°ä¸ºä¿®æ­£çº¿æ€§å•å…ƒï¼ˆRectified Linear Unitï¼‰ï¼Œæ˜¯ä¸€ç§åˆ†æ®µçº¿æ€§å‡½æ•°ï¼Œå¼¥è¡¥äº†sigmoidå‡½æ•°çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜(å³è¯¥å‡½æ•°ä¸¤ç«¯éå¸¸å¹³æ»‘ï¼Œå¯¼æ•°è¶‹è¿‘0ï¼Œé‡åˆ°æ•°å€¼åä¸¤ç«¯çš„æ•°æ®ï¼Œlosså¾ˆéš¾ä¼ æ’­):
<ul>
<li> $f(x)={\left\{\begin{array}{l l}{x}&{,x\gt =0}\\ {0}&{,x\lt 0}\end{array}\right.} $ </li>
</ul></li>
</ul>
<p><img src="/assets/ml/Pasted%20image%2020250402152918.png" /> <img src="/assets/ml/Pasted%20image%2020250402152932.png" /></p>
<p><strong>æŸå¤±å‡½æ•°loss function</strong>ï¼šè¯„ä¼°è®­ç»ƒæˆæœçš„ä¸€ä¸ªæ ‡å‡†ï¼Œè¶Šå°è¶Šå¥½<br />
loss = criterion(model_output, expected_value) #nn:neural network</p>
<ul>
<li><code>criterion = nn.MSELoss()</code>:Mean Squared Error</li>
<li><code>criterion = nn.CrossEntropyLoss()</code>:Cross Entropy äº¤å‰ç†µ</li>
</ul>
<h3 id="å¸¸è§é—®é¢˜">å¸¸è§é—®é¢˜</h3>
<ol type="1">
<li>æ¨¡å‹åå·®ï¼šæ¨¡å‹åœ¨è®­ç»ƒèµ„æ–™ä¸Šçš„æŸå¤±å‡½æ•°å¾ˆå¤§æ—¶ï¼Œå¯èƒ½æ˜¯å› ä¸ºåœ¨è¿™ä¸ªé—®é¢˜ä¸­é€‰æ‹©çš„æ¨¡å‹å¤ªè¿‡ç®€å•ï¼Œä»¥è‡³äºæ— è®ºç”¨è¿™ä¸ªç»™æ¨¡å‹é€‰æ‹©ä»€ä¹ˆæ ·çš„å‚æ•°Î¸ï¼ŒæŸå¤±å‡½æ•°f(Î¸)éƒ½ä¸ä¼šå˜å¾—å¾ˆå°</li>
<li>ä¼˜åŒ–é—®é¢˜ï¼Œæ¢¯åº¦ä¸‹é™çœ‹ä¸Šå»å¾ˆç¾å¥½ï¼Œä½†å¸¸å¸¸ä¼šå¡åœ¨ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜ï¼ˆlocal minimaï¼‰ç‚¹ï¼Œè¿™ä¸ªå±€éƒ¨æœ€ä¼˜å¯èƒ½å’Œå…¨å±€æœ€ä¼˜ï¼ˆglobal minimaï¼‰å·®å¾—å¾ˆè¿œï¼Œå› æ­¤éœ€è¦é€‰å–æ›´å¥½çš„ä¼˜åŒ–ç®—æ³•å¦‚ Adamï¼ŒRMSPropï¼ŒAdaGrad ç­‰</li>
<li>è¿‡æ‹Ÿåˆï¼Œè®­ç»ƒé›†Losså¾ˆå°ï¼Œæµ‹è¯•é›†å´å¾ˆå¤§ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é¦–å…ˆå¾—æ»¡è¶³å‰ä¸€ä¸ªæ¡ä»¶ï¼Œä¸ç„¶ä¹Ÿå¯èƒ½æ˜¯1.2.é—®é¢˜
<ol type="1">
<li>æœ€æœ‰æ•ˆçš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å¢åŠ è®­ç»ƒèµ„æ–™ï¼Œä½†å¾ˆå¤šæ—¶å€™æ˜¯æ— æ³•åšåˆ°çš„</li>
<li>ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯æ•°æ®å¢å¹¿ï¼ˆData Augmentationï¼‰ï¼Œå¸¸ç”¨äºå›¾åƒå¤„ç†ã€‚æ—¢ç„¶ä¸èƒ½å¢åŠ æ•°æ®ï¼Œé‚£å°±æ›´å¥½åœ°åˆ©ç”¨ç°æœ‰æ•°æ®ï¼›ä¾‹å¦‚ï¼šå¯¹å›¾åƒå·¦å³é•œåƒï¼Œæ”¹å˜æ¯”ä¾‹ç­‰ç­‰ï¼Œéœ€è¦æ³¨æ„ä¸èƒ½è¿‡åº¦æ”¹å˜æ•°æ®ç‰¹å¾ï¼Œä¾‹å¦‚ä¸Šä¸‹é¢ å€’å›¾ç‰‡</li>
<li>å¢åŠ å¯¹æ¨¡å‹çš„é™åˆ¶ï¼Œå¸¸è§å¦‚æ—©åœæ­¢ï¼Œæ­£åˆ™åŒ–ï¼Œä¸¢å¼ƒéƒ¨åˆ†ä¸åˆç†æ•°æ®ç­‰ç­‰</li>
</ol></li>
</ol>
<h3 id="ä¼˜åŒ–ç®—æ³•-optimizer">ä¼˜åŒ–ç®—æ³• optimizer</h3>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/optim.html">torch.optim</a><br />
e.g.</p>
<ol type="1">
<li>optimizer.zero_grad()ï¼šé‡è®¾æ¢¯åº¦(å³è®­ç»ƒå®Œä¸€æ®µåæ¢¯åº¦ç½®0,æˆªæ–­åå‘ä¼ æ’­å†ç»§ç»­è®­ç»ƒ)</li>
<li>Call loss.backward() åå‘ä¼ æ’­ä»¥å‡å°‘æŸå¤±</li>
<li>Call optimizer.step() è°ƒæ•´æ¨¡å‹å‚æ•°</li>
</ol>
<h4 id="å½’ä¸€åŒ–-normalization">å½’ä¸€åŒ– Normalization</h4>
<p>è®­ç»ƒä¸­çš„æ•°æ®å¾ˆå¤šæƒ…å†µä¸‹å¤§å°å®Œå…¨ä¸ç»Ÿä¸€ï¼ŒåŸºäºç›´è§‰çš„æƒ³æ³•æ˜¯ï¼šåŒä¸€ç»´åº¦çš„æ•°æ®æˆ‘ä»¬åªå…³å¿ƒå…¶ç›¸å¯¹å¤§å°å…³ç³»ï¼Œä¸åŒç»´åº¦çš„æ•°æ®æˆ‘ä»¬è®¤ä¸ºå®ƒä»¬çš„åœ°ä½å¹³ç­‰ï¼Œå°ºåº¦åº”åˆ°ä¸€è‡´ï¼Œæ‰€ä»¥éœ€è¦å½’ä¸€åŒ–<br />
ç®€å•åœ°è¯´å°±æ˜¯æŠŠä¸€ä¸ªç»´åº¦çš„æ•°æ®å¤§å°éƒ½è°ƒæ•´åˆ°<code>[0-1]</code>è¿™ä¸ªåŒºé—´ï¼Œä¾‹å¦‚softmaxå‡½æ•°å°±ç”¨äºå°†ä¸€ä¸ªå‘é‡è½¬åŒ–æˆæ¦‚ç‡åˆ†å¸ƒ(ä»¤å…¶æ€»å’Œä¸º1)</p>
<div class="note info"><p>å½’ä¸€åŒ–<strong>normalization</strong>å®¹æ˜“å’Œæ­£åˆ™åŒ–<strong>regularization</strong>ææ··ï¼Œæ¥çœ‹çœ‹è¯å…¸è§£é‡Šï¼š</p>
<ul>
<li>normalization: to start to consider something as normal, or to make something start to be considered as normal</li>
<li>regularization: the act of changing a situation or system so that it follows laws or rules, or is based on reason</li>
</ul>
<p>ä¹Ÿå°±æ˜¯ï¼Œå½’ä¸€åŒ–åå‘äºâ€œæ­£å¸¸â€ï¼Œæ­£åˆ™åŒ–åå‘äºâ€œè§„åˆ™â€ï¼Œå·®åˆ«éå¸¸å¾®å¦™ï¼Œä½†ç¡¬è¦è¯´çš„è¯ï¼Œ0-1çš„æ•°æ®çœ‹èµ·æ¥æ˜¯æ¯”å…¶ä»–çš„æ›´â€œæ­£å¸¸â€ä¸€ç‚¹</p>
<p>ç¥ç»ç½‘ç»œä¸­è¿›è¡Œçš„å¤„ç†æœ‰æ¨ç†(inference)å’Œå­¦ä¹ ä¸¤ä¸ªé˜¶æ®µã€‚ç¥ç»ç½‘ç»œä¸­æœªè¢«æ­£è§„ åŒ–(å½’ä¸€åŒ–)çš„è¾“å‡ºç»“æœæœ‰æ—¶è¢«ç§°ä¸ºâ€œå¾—åˆ†â€ã€‚ä¹Ÿå°±æ˜¯è¯´,å½“ç¥ç»ç½‘ç»œçš„æ¨ç†åªéœ€è¦ç»™å‡ºä¸€ä¸ªç­”æ¡ˆçš„æƒ…å†µä¸‹,å› ä¸ºæ­¤æ—¶åªå¯¹å¾—åˆ†æœ€å¤§å€¼æ„Ÿå…´è¶£,æ‰€ä»¥ä¸éœ€è¦ Softmax å±‚ã€‚ ä¸è¿‡,ç¥ç»ç½‘ç»œçš„å­¦ä¹ é˜¶æ®µåˆ™éœ€è¦ Softmax å±‚</p>
</div>
<h4 id="æ¢¯åº¦ä¸‹é™">æ¢¯åº¦ä¸‹é™</h4>
<p><strong>æ¢¯åº¦ä¸‹é™æ³•</strong>ï¼š<br />
æœ‰ç‚¹ç±»ä¼¼äºç‰›é¡¿æ³•(ç‰›é¡¿æ³•ç†è®ºæ˜¯äºŒé˜¶æ”¶æ•›ï¼Œæ¢¯åº¦åˆ™ä¸ºä¸€é˜¶ï¼Œç‰›é¡¿æ³•é€Ÿåº¦æ›´å¿«è®¡ç®—é‡æ›´å¤§)ï¼Œæ‰€è°“çš„æ¢¯åº¦å°±æ˜¯ä¸€ä¸ªå¤šå…ƒå‡½æ•°ä¸­ï¼Œå¯¹ä¸€ä¸ªç‚¹æ±‚å„ä¸ªå…ƒçš„åå¯¼æ•°å–å€¼ç»„æˆçš„ä¸€ä¸ªè¡¨ç¤ºæ–¹å‘çš„å‘é‡(å³åå¯¼æ•°ä¹˜å¯¹åº”å…ƒçš„å•ä½å‘é‡)<br />
è¿™ä¸ªæ¢¯åº¦ä¸€èˆ¬æŒ‡å‘å½“å‰ç‚¹å¢åŠ æœ€å¿«çš„æ–¹å‘ï¼ŒæŠŠä»–ä¹˜ä»¥-1å°±ä¼šå¾—åˆ°ä¸‹é™æœ€å¿«çš„æ–¹å‘(ä¸€èˆ¬ç”¨äºæœ€å°åŒ–æŸå¤±å‡½æ•°)ï¼Œæ¢¯åº¦åªè¡¨ç¤ºæ–¹å‘ï¼Œå› æ­¤è¿˜éœ€è¦é€‰æ‹©åˆé€‚çš„æ­¥é•¿Î±ï¼Œä¹˜ä»¥æ–¹å‘å‘é‡åå°±å¾—åˆ°ç§»åŠ¨çš„è·¯å¾„ï¼Œæ­¥é•¿å¤ªé•¿äº†ä¼šè·¨è¿‡æå°å€¼ç„¶åæ¥å›éœ‡è¡ï¼Œå¤ªçŸ­äº†æ•ˆç‡ä¼šå¾ˆå·®<br />
æ¢¯åº¦ä¸‹é™ç®—æ³•éœ€è¦è®¾ç½®ä¸€ä¸ª<strong>å­¦ä¹ ç‡(learning rate)</strong>ï¼Œæ¯æ¬¡è¿­ä»£ä¸­ï¼ŒæœªçŸ¥å‚æ•°çš„æ¢¯åº¦ä¸‹é™çš„æ­¥é•¿å–å†³äºå­¦ä¹ ç‡çš„è®¾ç½®ï¼Œè¿™ç§ç”±äººä¸ºè®¾å®šçš„å‚æ•°è¢«ç§°ä¸º<strong>è¶…å‚ï¼ˆhyperparametersï¼‰</strong><br />
å¦‚æœæˆ‘ä»¬çš„æ•°æ®é›†å¾ˆå¤§ï¼Œè®¡ç®—æ¢¯åº¦ä¼šç›¸å½“å¤æ‚ï¼Œåˆ™å¯ä»¥åˆ†ä¸ºnä¸ªbatch,æ¯ä¸ªbatchæœ‰Bä¸ªèµ„æ–™ï¼Œå³ <strong>mini-batch æ¢¯åº¦ä¸‹é™ï¼ˆMBGDï¼ŒMini-Batch GradientDescent</strong><br />
åœ¨numpyé‡Œç”¨å½¢å¦‚<code>np.random.choice(scope, num)</code>çš„æ–¹æ³•å°±å¯ä»¥åœ¨scopeå†…éšæœºé€‰å–numä¸ªç´¢å¼•ä½œä¸ºmini batch</p>
<h4 id="åå‘ä¼ æ’­">åå‘ä¼ æ’­</h4>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/charlotte77/p/5629865.html">é€šä¿—è®²è§£åå‘ä¼ æ’­</a><br />
åå‘ä¼ æ’­æ˜¯æ¢¯åº¦ä¸‹é™åœ¨ç¥ç»ç½‘ç»œä¸Šçš„å…·ä½“å®ç°æ–¹å¼ï¼Œä¸å‰å‘è®­ç»ƒè¿‡ç¨‹ç›¸åï¼Œç”¨ç»“æœçš„æŸå¤±å€¼ä¿®æ­£è®­ç»ƒä¸­çš„æƒå€¼ï¼Œåœ¨æ•°å­¦ä¸Šå°±æ˜¯æ±‚æŸå¤±å¯¹å‰ä¸€å±‚æƒé‡çš„åå¯¼æ•°<br />
ä½†æ˜¯æŸå¤±å‡½æ•°çš„å‚æ•°æ˜¯æœ¬å±‚çš„è¾“å‡ºå€¼ï¼Œå› æ­¤éœ€è¦é“¾å¼æ³•åˆ™æ±‚åå¯¼ï¼Œå…ˆæ±‚å‡ºæŸå¤±å‡½æ•°å¯¹è¾“å‡ºçš„åå¯¼ï¼Œå†ä¹˜ä»¥æœ¬å±‚è¾“å‡ºå¯¹å‰ä¸€å±‚æƒé‡çš„åå¯¼(å½“ç„¶æˆ‘ä»¬çŸ¥é“æœ¬å±‚ç¥ç»å…ƒæ”¶åˆ°ä¸Šå±‚çš„è¾“å‡ºåè¿˜è¦ç®—ä¸ªæ¿€æ´»å‡½æ•°æ‰èƒ½å¾—åˆ°æœ€åçš„è¾“å‡ºï¼Œå› æ­¤ä¸­é—´è¿˜æœ‰ä¸€æ­¥æœ¬å±‚è¾“å‡ºå¯¹ä¸Šå±‚è¾“å‡ºæ±‚åå¯¼ï¼Œåªæœ‰ä¸Šå±‚è¾“å‡ºç›´æ¥å’Œä¸Šå±‚æƒé‡æœ‰å…³)</p>
<p><img src="/assets/ml/pk7amw95.png" /> å¦‚å›¾ï¼Œæƒé‡ç»“åˆä¸Šå±‚outå¾—åˆ°net,netç»è¿‡æ¿€æ´»å‡½æ•°å¾—åˆ°æœ¬å±‚outï¼Œæœ¬å±‚outç”¨æ¥è®¡ç®—æŸå¤±å€¼ï¼Œå› æ­¤åå‘ä¼ æ’­ä¼šåè¿‡æ¥ç®—<br />
å¯¹ç€è¿™äº›å¤æ‚çš„åç§°æ±‚åå¯¼æ•°çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œä½†è¿™å’Œå¸¸è§çš„yxæ²¡ä»€ä¹ˆä¸åŒ<br />
å¾—åˆ°åå¯¼å‡½æ•°åï¼Œæ¥ä¸‹æ¥æ­£å¦‚åœ¨æ¢¯åº¦ä¸‹é™ä¸­å­¦åˆ°çš„ï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ä¸æ–­è°ƒæ•´ä¸Šå±‚æƒé‡æ¥æœ€å°åŒ–ç»“æœå±‚çš„æŸå¤±å‡½æ•°ï¼Œæ¯æ¬¡ç”¨ä¸€ä¸ªâ€œå­¦ä¹ é€Ÿç‡ <span class="math inline">\(\eta\)</span> â€ä¹˜ä»¥åå¯¼æ•°æ¥æ›´æ–°æƒé‡</p>
<p><img src="/assets/ml/o7aq5jae.png" /></p>
<p>æ¶‰åŠéšè—å±‚æ—¶ç¨å¾®æœ‰æ‰€ä¸åŒï¼Œåœ¨ç”±äºéšè—å±‚çš„ä¸‹ä¸€å±‚ä¼šè¿åˆ°ä¸åŒçš„ç»“æœï¼Œä¹Ÿå°±ä¼šäº§ç”Ÿå¤šä¸ªæŸå¤±å€¼ï¼Œåœ¨outéƒ¨åˆ†éœ€è¦å¯¹ä¸åŒçš„æŸå¤±å€¼æ±‚åå¯¼ï¼Œå³æ€»è¯¯å·®å¯¹outh1çš„åå¯¼æ˜¯E(o1)å’ŒE(o2)å¯¹outh1åå¯¼çš„å’Œ</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dataset = MyDataset(file)</span><br><span class="line">tr_set = DataLoader(dataset, <span class="number">16</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">model = MyModel().to(device)</span><br><span class="line">criterion = nn.MSELoss()</span><br><span class="line">optimizer = torch.optim.SGD(model.parameters(), <span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(n_epochs):</span><br><span class="line">    model.train()</span><br><span class="line">    <span class="keyword">for</span> x, y <span class="keyword">in</span> tr_set:</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        x, y = x.to(device), y.to(device)</span><br><span class="line">        pred = model(x)</span><br><span class="line">        loss = criterion(pred, y)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step() <span class="comment">#æ›´æ–°æ¨¡å‹çš„å‚æ•°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div class="note info"><p><strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼š</p>
<p>å¦‚æœæˆ‘ä»¬ç”¨æœ€å¸¸è§çš„sigmoidå‡½æ•°ï¼Œä¸”åœ¨æŸå±‚ä¸Šè¾“å…¥å€¼åœ¨å‡½æ•°çš„ä¸¤ç«¯ï¼Œæ­¤æ—¶å¯¼æ•°éå¸¸å°ï¼Œä¹Ÿå°±æ˜¯æ¢¯åº¦éå¸¸å°ï¼Œè¿™å±‚ä¸Šçš„åå‘ä¼ æ’­å‡ ä¹æ— æ³•æ›´æ–°ï¼Œä¸ä»…å¦‚æ­¤ï¼Œæ›´ä¹‹å‰çš„å±‚çº§ä¹Ÿå¾ˆéš¾ç»§ç»­ä¼ æ’­ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚<br />
é™¤äº†æ›´æ–°ç¼“æ…¢é—®é¢˜å¤–ï¼Œè¿™è¿˜ä¼šå¯¼è‡´æµ…å±‚å’Œæ·±å±‚çš„æ›´æ–°ç¨‹åº¦åŒºåˆ«å·¨å¤§ï¼Œè®©æ¨¡å‹å˜å¾—â€œä¸å‡åŒ€â€ï¼Œæ­¤å¤–ï¼Œç”±äºsigå‡½æ•°çš„æ¢¯åº¦åŒºé—´è¾ƒå°ï¼Œæ¨¡å‹æ·±äº†å‡ ä¹å¿…ç„¶æœ‰è¿™ç§é—®é¢˜</p>
<p>ReLUç”¨äºè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå…¶æ¢¯åº¦è¦ä¹ˆæ˜¯0è¦ä¹ˆæ˜¯1ï¼Œåªåœ¨è´Ÿç«¯æ¶ˆå¤±ï¼Œè¿™æ ·æœ‰ä¸ªå¯èƒ½çš„å¥½å¤„ï¼Œå¦‚æœè´Ÿç«¯çš„æ•°æ®å…¶å®æ˜¯å™ªå£°æˆ–è€…æ˜¯ä¸€äº›æˆ‘ä»¬ä¸å…³æ³¨çš„ç‰¹å¾ï¼Œé‚£ä¹ˆæ‰”æ‰åè€Œä¼šè®©æ¨¡å‹æ•ˆæœæ›´å¥½<br />
è¿™ç§æ¿€æ´»å‡½æ•°çš„ç¼ºç‚¹æ˜¯ï¼Œæ¢¯åº¦éè´Ÿæ•°ï¼Œå¯¹äºä¸€å±‚æ‰€æœ‰çš„wï¼Œæ¢¯åº¦çš„ç¬¦å·éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªèƒ½ä¸€èµ·å¢å¤§æˆ–è€…å‡å°ï¼Œè¿™å¯èƒ½å‡å°‘æ¨¡å‹çš„å‡†ç¡®åº¦<br />
é€šå¸¸ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å…¥å€¼æœ‰ä¸€é¡¹åç½®é¡¹(bias)ï¼Œå‡è®¾biaså˜å¾—å¤ªå°ï¼Œä»¥è‡³äºè¾“å…¥æ¿€æ´»å‡½æ•°çš„å€¼æ€»æ˜¯è´Ÿçš„ï¼Œé‚£ä¹ˆåå‘ä¼ æ’­è¿‡ç¨‹ç»è¿‡è¯¥å¤„çš„æ¢¯åº¦æ’ä¸º0,å¯¹åº”çš„æƒé‡å’Œåç½®å‚æ•°æ­¤æ¬¡æ— æ³•å¾—åˆ°æ›´æ–°ã€‚å¦‚æœå¯¹äºæ‰€æœ‰çš„æ ·æœ¬è¾“å…¥ï¼Œè¯¥æ¿€æ´»å‡½æ•°çš„è¾“å…¥éƒ½æ˜¯è´Ÿçš„ï¼Œé‚£ä¹ˆè¯¥ç¥ç»å…ƒå†ä¹Ÿæ— æ³•å­¦ä¹ ï¼Œç§°ä¸ºç¥ç»å…ƒâ€æ­»äº¡â€œé—®é¢˜</p>
<p>LeakyReLUçš„æå‡ºå°±æ˜¯ä¸ºäº†è§£å†³ç¥ç»å…ƒâ€æ­»äº¡â€œé—®é¢˜ï¼Œå…¶è¾“å…¥å°äº0çš„éƒ¨åˆ†ï¼Œå€¼ä¸ºè´Ÿï¼Œä¸”æœ‰å¾®å°çš„æ¢¯åº¦ï¼Œé™¤äº†é¿å…æ­»äº¡è¿˜æœ‰ä¸€ä¸ªå¯èƒ½çš„å¥½å¤„æ˜¯ï¼Œè¯¥å¾®å°çš„æ¢¯åº¦å¯èƒ½è®©è®­ç»ƒæœ‰ä¸€äº›å¾®å°çš„æŒ¯åŠ¨ï¼Œåœ¨ç‰¹å®šæƒ…å†µèƒ½è·³å‡ºå±€éƒ¨æœ€ä¼˜è§£</p>
<p>pythonå®ç°:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">x</span>): </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x)) <span class="comment">#NumPyçš„å¹¿æ’­ç‰¹æ€§:å¦‚æœåœ¨æ ‡é‡å’Œ NumPy æ•°ç»„ä¹‹é—´è¿›è¡Œè¿ç®—,åˆ™æ ‡é‡ä¼šå’Œ NumPy æ•°ç»„çš„å„ä¸ªå…ƒç´ è¿›è¡Œè¿ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">relu</span>(<span class="params">x</span>): </span><br><span class="line">    <span class="keyword">return</span> np.maximum(<span class="number">0</span>, x)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div>
<p>å‚è€ƒé¡¹ç›®:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/huggingface/transformers">Huggingface Transformers</a> (transformer models: BERT, GPT, ...)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/pytorch/fairseq">Fairse</a> (sequence modeling for NLP &amp; speech)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/espnet/espnet">ESPnet</a> (speech recognition, translation, synthesis, ...)</li>
</ul>
<h4 id="momentum">Momentum</h4>
<p>æ¢¯åº¦ä¸‹é™ç®€å•æ˜“æ‡‚ï¼Œä½†å½“ç„¶ä¹Ÿå­˜åœ¨é—®é¢˜ï¼Œè€ƒè™‘å¦‚ä¸‹çš„å‡½æ•°ï¼š</p>
<p><span class="math display">\[f(x,y)=\frac{1}{20}x^{2}+y^{2}\]</span></p>
<p>å…¶xè½´æ¢¯åº¦è¿œå°äºyè½´æ¢¯åº¦ï¼Œå‡½æ•°åƒä¸€ä¸ªå±±å²­ï¼Œä½†åº•éƒ¨æ˜¯ä¸ªèµ·ä¼ä¸å¤§çš„æŠ›ç‰©çº¿ï¼Œæ›´æ–°è·¯å¾„æ˜¯ä¸€ä¸ªä¸ªä¹‹å­—å½¢ï¼Œyè½´æ›´æ–°åœ°å¿«ä¸æ–­éœ‡è¡ï¼Œxè½´åˆ™æ…¢æ…¢å‘çœŸæ­£çš„åº•éƒ¨å‰è¿›<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹éå‡å‘(anisotropic)çš„å‡½æ•°ï¼Œæ¢¯åº¦ä¸‹é™æ•ˆç‡æœ‰é™</p>
<p>Momentum(åŠ¨é‡)æ˜¯ä¸€ç§æ”¹è¿›çš„ä¼˜åŒ–æ–¹å¼ï¼Œè¿™é‡Œä¸ç®¡å…¶ç‰©ç†å«ä¹‰ï¼Œå…·ä½“æ›´æ–°æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><span class="math display">\[v\leftarrow\alpha v-\eta{\frac{\partial L}{\partial W}}\]</span> <span class="math display">\[W\leftarrow W+v\]</span></p>
<p>å…¶ä»–å˜é‡æˆ‘ä»¬éƒ½çŸ¥é“äº†ï¼Œè¿™ä¸ªvå¯¹åº”ç‰©ç†ä¸Šçš„é€Ÿåº¦ï¼Œè¡¨ç¤ºç‰©ä½“åœ¨æ¢¯åº¦æ–¹å‘å—åŠ›ï¼ŒÎ±æ¨¡æ‹Ÿç±»ä¼¼æ‘©æ“¦åŠ›å¯¼è‡´çš„å‡é€Ÿï¼Œä¸€èˆ¬æ¯”1ç•¥å°ï¼Œå¦‚0.9ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸæ¥çš„æ¢¯åº¦ä¸‹é™å¯è§†ä¸ºæ— é˜»åŠ›çš„è¿åŠ¨ï¼ŒåŠ¨é‡æ³•è®©å…¶é€Ÿåº¦è¶Šæ¥è¶Šæ…¢ï¼Œè¿™å¯ä»¥æœ‰æ•ˆå‡å°‘è·¯å¾„çš„æŠ˜çº¿æƒ…å†µ</p>
<h4 id="adagrad">AdaGrad</h4>
<p>å­¦ä¹ ç‡è¡°å‡(learning rate decay),å³éšç€å­¦ä¹ çš„è¿›è¡Œ,ä½¿å­¦ä¹ ç‡é€æ¸å‡å°æ˜¯ä¸€ç§å¸¸è§çš„æ€è·¯ï¼›AdaGradè¿›ä¸€æ­¥å‘å±•äº†è¿™ä¸ªæƒ³æ³•,é’ˆå¯¹ä¸åŒå‚æ•°,èµ‹äºˆç›¸äº’ç‹¬ç«‹çš„å­¦ä¹ ç‡ï¼Œå³Adaptive Grad</p>
<p><span class="math display">\[h\leftarrow h+{\frac{\partial L}{\partial W}}\leftarrow{\frac{\partial L}{\partial W}}\]</span> <span class="math display">\[W\leftarrow W-\eta\frac{1}{\sqrt{h}}\frac{\partial L}{\partial W}\]</span></p>
<p>hä¿å­˜äº†ä»¥å‰çš„æ‰€æœ‰æ¢¯åº¦å€¼çš„å¹³æ–¹å’Œ,è¿™æ ·èƒ½å¤ŸæŒ‰å‚æ•°çš„å…ƒç´ è¿›è¡Œå­¦ä¹ ç‡è¡°å‡,ä½¿å˜åŠ¨å¤§çš„å‚æ•°çš„å­¦ä¹ ç‡é€æ¸å‡å°ï¼Œç›´è‡³æ— é™æ¥è¿‘0ï¼›RMSProp æ–¹æ³•ä¼šèˆå¼ƒä¸€äº›æ¯”è¾ƒæ—©çš„æ¢¯åº¦é¿å…è¿™ä¸ªé—®é¢˜<br />
ä¸ºäº†é¿å…æ£˜æ‰‹çš„é™¤0é—®é¢˜ï¼Œhçš„å¹³æ–¹æ ¹å¯ä»¥åŠ ä¸€ä¸ªå¾®å°å€¼å¦‚1e-7</p>
<p><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1412.6980">adam</a>æ˜¯2015å¹´æå‡ºçš„æ–°æ–¹æ³•,ç›´è§‚ä½†ä¸å‡†ç¡®åœ°è¯´å°±æ˜¯èåˆäº† Momentum å’Œ AdaGrad çš„æ–¹æ³•</p>
<h3 id="æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</h3>
<p>æ­£åˆ™åŒ–æŒ‡ä¸ºè§£å†³é€‚å®šæ€§é—®é¢˜æˆ–è¿‡æ‹Ÿåˆè€ŒåŠ å…¥é¢å¤–ä¿¡æ¯çš„è¿‡ç¨‹ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¸¸è§çš„å°±æ˜¯ä¸ºæŸå¤±å‡½æ•°æ·»åŠ ä¸€äº›è°ƒæ•´é¡¹<br />
æ ¹æ®å‰æ–‡æ‰€è¿°ï¼Œå­¦ä¹ çš„è¿‡ç¨‹å°±æ˜¯æ ¹æ®æŸå¤±å‡½æ•°ä¸æƒé‡çš„å…³ç³»ä¸æ–­è°ƒæ•´æƒé‡ä»¥æœ€å°åŒ–æŸå¤±ï¼Œè€Œæ­£åˆ™åŒ–çš„ç›®çš„æ˜¯ä¸è¦è®©æƒé‡å…³ç³»å¤ªå¤æ‚ä»¥è‡´äºæ²¡æœ‰æ™®é€‚æ€§ã€‚æˆ‘ä»¬å°†åŸå§‹çš„æŸå¤±å‡½æ•°ç”»ä¸€ä¸ªå›¾ï¼Œæ­£åˆ™é¡¹å†ç”»ä¸€ä¸ªå›¾ï¼Œéœ€è¦æ‰¾çš„å°±æ˜¯ä¸¤ä¸ªå‡½æ•°åŒæ ·æƒé‡åŸºç¡€ä¸Šçš„æœ€å°å’Œ<br />
ç”¨æ¯”è¾ƒç®€å•çš„åŒæƒé‡ï¼Œå‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°æ¥è¯´ï¼Œw1,w2å°±æ˜¯xyè½´ï¼Œæœ€åçš„lossä½œä¸ºzè½´ï¼ŒåŸå§‹æŸå¤±å‡½æ•°Lå¯èƒ½åƒå¥‡ç™¾æ€ªï¼Œä½†æœ€åè¦æ‰¾çš„æ˜¯å…¶ä¸æ­£åˆ™é¡¹çš„æœ€å°å’Œ.è¿™ä¸ªå€¼é€šå¸¸åœ¨ä¸¤ä¸ªå‡½æ•°çš„äº¤ç‚¹å–ï¼Œè€Œ(äºŒç»´å±‚é¢ä¸Š)L1çš„å›¾åƒæ˜¯è±å½¢ï¼Œl2æ˜¯ä¸ªåœ†ï¼Œç¬¦åˆç›´è§‚åœ°æ¨å¯¼ï¼Œå‰è€…äº¤ç‚¹å¾ˆå®¹æ˜“åœ¨åæ ‡è½´ä¸Šå–ï¼Œåè€…å®¹æ˜“åœ¨ç¦»åæ ‡è½´è¿‘çš„åœ°æ–¹å–ï¼Œå³l1å®¹æ˜“è®©æƒé‡ç¨€ç–ï¼ŒL2å®¹æ˜“è®©å®ƒä»¬çš„å€¼çš„ç»å¯¹å€¼è¾ƒå°ä¸”åˆ†å¸ƒå‡åŒ€<br />
æ•°å­¦ä¸Šè®²ï¼ŒæŠ›å¼€ä¸ç¡®å®šçš„æŸå¤±å‡½æ•°ï¼Œl1æ­£åˆ™é¡¹çš„å¯¼æ•°æ˜¯wÃ—æ­£è´Ÿä¿¡å·é‡ï¼Œè¿­ä»£æ—¶å¦‚æœwå¤§äº0ä¼šå‡å°‘ï¼Œå¤§äº0ä¼šå¢åŠ ï¼Œæœ€åå¾ˆå®¹æ˜“å˜æˆ0ï¼›è€Œl2çš„å¯¼æ•°æ˜¯wçš„ä¸€æ¬¡å‡½æ•°ä¸”ä¸€æ¬¡é¡¹ç³»æ•°å°äº1ï¼Œè¿­ä»£è®©wä¸æ–­å‡å°ï¼Œè¿™ä¸ªå‡å°é‡ä¸wæœ¬èº«æœ‰å…³ï¼Œå› æ­¤ä¸€èˆ¬æ¥è¯´ä¸å®¹æ˜“å‡åˆ°0</p>
<h3 id="è®­ç»ƒæŠ€å·§">è®­ç»ƒæŠ€å·§</h3>
<h4 id="åˆå§‹æƒå€¼">åˆå§‹æƒå€¼</h4>
<p>ä»€ä¹ˆæ˜¯æœ€å¥½çš„åˆå§‹æƒé‡ï¼Ÿè¿™ä¸ªé—®é¢˜å¾ˆéš¾å›ç­”ï¼Œä¸å¦‚åè¿‡æ¥ä¸¾ä¸€äº›åä¾‹<br />
ç›¸åŒçš„æƒé‡è‚¯å®šæ˜¯æœ€åçš„é€‰æ‹©ï¼Œç”±äºéšæœºæ¢¯åº¦ä¸‹é™æ³•å¯¹ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„æƒå€¼ä¼šæœ‰éå¸¸ç›¸ä¼¼çš„ä¼ å¯¼æ•ˆæœï¼Œæœ€ç»ˆæ¨¡å‹çš„æƒå€¼ä¹Ÿä¼šè¶‹åŒï¼Œé™ä½å…¶è¡¨è¾¾åŠ›</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ç”¨é«˜æ–¯åˆ†å¸ƒæ¥åˆå§‹æƒé‡ï¼Œä¾‹å¦‚å¸¸ç”¨çš„Xavieråˆå§‹å€¼æ ¹æ®ä¸Šå±‚(ä»¥åŠä¸‹å±‚)çš„èŠ‚ç‚¹æ•°é‡ç¡®å®šåˆå§‹æƒé‡çš„åˆ†å¸ƒï¼Œä¾‹å¦‚åœ¨ä¸å‰ä¸€å±‚æœ‰nä¸ªèŠ‚ç‚¹è¿æ¥æ—¶,åˆå§‹å€¼ä½¿ç”¨æ ‡å‡†å·®ä¸º <span class="math inline">\(\frac{1}{\sqrt{n}}\)</span> çš„åˆ†å¸ƒ<br />
Xavieråˆå§‹å€¼æ˜¯ä»¥æ¿€æ´»å‡½æ•°æ˜¯çº¿æ€§å‡½æ•°ä¸ºå‰æè€Œæ¨å¯¼å‡ºæ¥çš„ã€‚å› ä¸ºsigmoidå‡½æ•°å’Œtanhå‡½æ•°å·¦å³å¯¹ç§°,ä¸”ä¸­å¤®é™„è¿‘å¯ä»¥è§†ä½œçº¿æ€§å‡½æ•°,æ‰€ä»¥é€‚åˆä½¿ç”¨Xavieråˆå§‹å€¼ã€‚ä½†å½“æ¿€æ´»å‡½æ•°ä½¿ç”¨ReLUæ—¶,ä¸€èˆ¬æ¨èä½¿ç”¨ReLUä¸“ç”¨çš„åˆå§‹å€¼,ä¹Ÿå°±æ˜¯Kaiming Heç­‰äººæ¨èçš„åˆå§‹å€¼,ä¹Ÿç§°ä¸ºâ€œHeåˆå§‹å€¼â€<br />
å½“å‰ä¸€å±‚çš„èŠ‚ç‚¹æ•°ä¸ºnæ—¶,Heåˆå§‹å€¼ä½¿ç”¨æ ‡å‡†å·®ä¸º <span class="math inline">\(\sqrt{\frac{2}{n}}\)</span> çš„é«˜æ–¯åˆ†å¸ƒã€‚å½“Xavieråˆå§‹å€¼æ˜¯ <span class="math inline">\({\sqrt{\frac{1}{n}}}\)</span> æ—¶,(ç›´è§‚ä¸Š)å¯ä»¥è§£é‡Šä¸º,å› ä¸ºReLUçš„è´Ÿå€¼åŒºåŸŸçš„å€¼ä¸º0,ä¸ºäº†ä½¿å®ƒæ›´æœ‰å¹¿åº¦,æ‰€ä»¥éœ€è¦2å€çš„ç³»æ•°</p>
<h4 id="batch-normalization">Batch Normalization</h4>
<p>Batch Normçš„æ€è·¯æ˜¯è°ƒæ•´å„å±‚çš„æ¿€æ´»å€¼åˆ†å¸ƒä½¿å…¶æ‹¥æœ‰é€‚å½“çš„å¹¿åº¦,å…·ä½“è€Œè¨€,å°±æ˜¯è¿›è¡Œä½¿æ•°æ®åˆ†å¸ƒçš„å‡å€¼ä¸º0ã€æ–¹å·®ä¸º1çš„æ­£è§„åŒ–</p>
<p><span class="math display">\[\mu_{B}\,\leftarrow\,\frac{1}{m}\sum_{i=1}^{m}x_{i}\]</span> <span class="math display">\[\sigma_{B}^{2}\iff\sum_{i=1}^{m}(x_{i}-\mu_{B})^{2}\]</span> <span class="math display">\[\hat{x}_{i}\enspace\leftarrow\ \frac{x_{i}\leftarrow\mu_{B}}{\sqrt{\sigma_{B}^{2}\,+\,\varepsilon}}\,\]</span></p>
<p>Îµ æ˜¯ä¸€ä¸ªå¾®å°å€¼ï¼Œç”¨æ¥é˜²æ­¢é™¤0</p>
<p>Batch Norm å±‚ä¼šå¯¹æ­£è§„åŒ–åçš„æ•°æ®è¿›è¡Œç¼©æ”¾å’Œå¹³ç§»çš„å˜æ¢:</p>
<p><span class="math display">\[y i\longleftarrow\gamma\hat{x}_{i}+\beta\]</span></p>
<p>Î³ã€Î²æ˜¯å‚æ•°ï¼Œåˆå§‹ä¸º1ã€0ï¼Œéšåæ ¹æ®å­¦ä¹ æ¥è°ƒæ•´</p>
<h4 id="æŠ‘åˆ¶è¿‡æ‹Ÿåˆ">æŠ‘åˆ¶è¿‡æ‹Ÿåˆ</h4>
<p><strong>æƒå€¼è¡°å‡</strong>ï¼šä¸ºæŸå¤±å‡½æ•°åŠ ä¸Šæƒé‡çš„å¹³æ–¹èŒƒæ•°(L2èŒƒæ•°)ï¼Œå³è®©æ­£åˆ™é¡¹ä¸º <span class="math inline">\(\textstyle{ {\frac{1}{2}}\lambda W^{2} }\)</span> ï¼Œå…¶ä¸­Î»æ˜¯æ§åˆ¶æ­£åˆ™åŒ–å¼ºåº¦çš„è¶…å‚æ•°ï¼Œå…¶æ¢¯åº¦ä¹Ÿä¼šåŠ ä¸Šä¸€ä¸ªÎ»W</p>
<p><strong>dropout</strong>ï¼šåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­éšæœºåˆ é™¤ç¥ç»å…ƒï¼Œåœæ­¢å‘å‰ä¼ é€’ä¿¡å·</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dropout</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, dropout_ratio=<span class="number">0.5</span></span>):</span><br><span class="line">        self.dropout_ratio = dropout_ratio</span><br><span class="line">        self.mask = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x, train_flg=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">if</span> train_flg:</span><br><span class="line">            self.mask = np.random.rand(*x.shape) &gt; self.dropout_ratio<span class="comment">#*x.shape å°† x çš„å½¢çŠ¶è§£åŒ…</span></span><br><span class="line">            <span class="keyword">return</span> x * self.mask</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> x * (<span class="number">1.0</span> - self.dropout_ratio)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">backward</span>(<span class="params">self, dout</span>):</span><br><span class="line">        <span class="keyword">return</span> dout * self.mask</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>é›†æˆå­¦ä¹ </strong>ï¼šè®©å¤šä¸ªæ¨¡å‹å•ç‹¬è¿›è¡Œå­¦ä¹ ,æ¨ç†æ—¶å†å–å¤šä¸ªæ¨¡å‹çš„è¾“å‡ºçš„å¹³å‡å€¼ã€‚Dropoutå¯ä»¥ç†è§£ä¸ºï¼šé€šè¿‡åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­éšæœºåˆ é™¤ç¥ç»å…ƒ,ä»è€Œæ¯ä¸€æ¬¡éƒ½è®©ä¸åŒçš„æ¨¡å‹è¿›è¡Œå­¦ä¹ ï¼›æ¨ç†æ—¶,é€šè¿‡å¯¹ç¥ç»å…ƒçš„è¾“å‡ºä¹˜ä»¥åˆ é™¤æ¯”ä¾‹,å¯ä»¥å–å¾—æ¨¡å‹çš„å¹³å‡å€¼ã€‚</p>
<h4 id="è¶…å‚æ•°">è¶…å‚æ•°</h4>
<p>è¶…å‚æ•°(hyper-parameter)ï¼šå¦‚å„å±‚çš„ç¥ç»å…ƒæ•°é‡ã€batch å¤§å°ã€å‚ æ•°æ›´æ–°æ—¶çš„å­¦ä¹ ç‡æˆ–æƒå€¼è¡°å‡ç­‰<br />
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½ä½¿ç”¨æµ‹è¯•æ•°æ®è¯„ä¼°è¶…å‚æ•°çš„æ€§èƒ½ï¼Œå¦åˆ™ä¼šè®©è¶…å‚æ•°çš„å€¼ä¼šå¯¹æµ‹è¯•æ•°æ®å‘ç”Ÿè¿‡æ‹Ÿåˆï¼Œä¸€èˆ¬ç”¨éªŒè¯æ•°æ®æ¥è¯„ä¼°æ€§èƒ½ <a target="_blank" rel="noopener" href="https://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf">æœ‰æŠ¥å‘Šæ˜¾ç¤º</a>ï¼Œåœ¨è¿›è¡Œç¥ç»ç½‘ç»œçš„è¶…å‚æ•°çš„æœ€ä¼˜åŒ–æ—¶,ä¸ç½‘æ ¼æœç´¢ç­‰æœ‰è§„å¾‹çš„æœç´¢ç›¸æ¯”,éšæœºé‡‡æ ·çš„æœç´¢æ–¹å¼æ•ˆæœæ›´å¥½ã€‚è¿™æ˜¯å› ä¸ºåœ¨ å¤šä¸ªè¶…å‚æ•°ä¸­,å„ä¸ªè¶…å‚æ•°å¯¹æœ€ç»ˆçš„è¯†åˆ«ç²¾åº¦çš„å½±å“ç¨‹åº¦ä¸åŒ å¤§è‡´çš„æ­¥éª¤æ˜¯ï¼š</p>
<ol type="1">
<li>è®¾å®šè¶…å‚æ•°çš„èŒƒå›´</li>
<li>ä»è®¾å®šçš„è¶…å‚æ•°èŒƒå›´ä¸­éšæœºé‡‡æ ·</li>
<li>ä½¿ç”¨1.ä¸­é‡‡æ ·åˆ°çš„è¶…å‚æ•°çš„å€¼è¿›è¡Œå­¦ä¹ ,é€šè¿‡éªŒè¯æ•°æ®è¯„ä¼°è¯†åˆ«ç²¾åº¦(ä½†æ˜¯è¦å°†epochè®¾ç½®å¾—å¾ˆå°)</li>
<li>é‡å¤1. 2. ä¸æ–­ç¼©å°å‚æ•°åˆ°ä¸€ä¸ªåˆç†çš„å€¼</li>
</ol>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">weight_decay = <span class="number">10</span> ** np.random.uniform(-<span class="number">8</span>, -<span class="number">4</span>)<span class="comment">#uniformç”ŸæˆæŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°,é»˜è®¤0ç»´åº¦ï¼Œå¯ä»¥æŒ‡å®šç»´åº¦</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ç¥ç»ç½‘ç»œæ¨¡å‹">ç¥ç»ç½‘ç»œæ¨¡å‹</h1>
<h2 id="python-ç›¸å…³">python ç›¸å…³</h2>
<ul>
<li><code>DataLoader(train_date,shuffle=True)</code>ä¸­shuffleè¡¨ç¤ºæ‰“ä¹±æ•°æ®é›†ï¼Œç¬¦åˆç›´è§‰çš„æƒ³æ³•æ˜¯ï¼šè¿™å¯¹é¿å…è¿‡æ‹Ÿåˆæœ‰å¸®åŠ©<br />
</li>
<li>epochæ˜¯ä¸€ä¸ªå•ä½ã€‚ä¸€ä¸ªepochè¡¨ç¤ºå­¦ä¹ ä¸­æ‰€æœ‰è®­ç»ƒæ•°æ®å‡è¢«ä½¿ç”¨è¿‡ä¸€æ¬¡æ—¶çš„æ›´æ–°æ¬¡æ•°ã€‚æ¯”å¦‚,å¯¹äº 10000 ç¬”è®­ç»ƒæ•°æ®,ç”¨å¤§å°ä¸º100ç¬”æ•°æ®çš„mini-batchè¿›è¡Œå­¦ä¹ æ—¶,é‡å¤éšæœºæ¢¯åº¦ä¸‹é™æ³•100æ¬¡,æ‰€æœ‰çš„è®­ç»ƒæ•°æ®å°±éƒ½è¢«â€œçœ‹è¿‡â€äº†ã€‚æ­¤æ—¶,100æ¬¡å°±æ˜¯ä¸€ä¸ªepoch</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">My_model</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">selfï¼Œinputdim</span>):</span><br><span class="line">        <span class="built_in">super</span>(My_model,self).__init__()</span><br><span class="line">        self.layers=nn.sequential(<span class="comment">#å°†å¤šä¸ªå±‚æŒ‰é¡ºåºç»„åˆåœ¨ä¸€èµ·</span></span><br><span class="line">            nn.Linear(input_dim,<span class="number">64</span>), </span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">64</span>ï¼Œ<span class="number">32</span>),</span><br><span class="line">            nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">32</span>ï¼Œ<span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.layers(x)</span><br><span class="line">        x = x.sgueeze(<span class="number">1</span>)<span class="comment">#(B,l) -&gt; B</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment">#Training loop</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3000</span>):</span><br><span class="line">    model.train() <span class="comment"># Set your model to train mode.</span></span><br><span class="line">    <span class="comment"># tgdm is a package to visualize your training progress</span></span><br><span class="line">    train_pbar = tqdm(train_loader, position=<span class="number">0</span>, leave=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> x, y <span class="keyword">in</span> train_pbar:</span><br><span class="line">        x, y = x.to(<span class="string">&#x27;cuda&#x27;</span>), y.to(<span class="string">&#x27;cuda&#x27;</span>)</span><br><span class="line">        pred = model(x)</span><br><span class="line">        loss = criterion(pred, y)</span><br><span class="line">        loss.backward()<span class="comment"># Compute gradient(backpropagation).</span></span><br><span class="line">        optimizer.step()<span class="comment"># Update parameters.</span></span><br><span class="line">        optimizer.zero_grad() <span class="comment"># Set gradient to zero.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/">PyTorch Documentation</a></p>
<p>å¹¿æ’­æœºåˆ¶(broadcasting mechanism):</p>
<ol type="1">
<li>é€šè¿‡é€‚å½“å¤åˆ¶å…ƒç´ æ¥æ‰©å±•ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ•°ç»„,ä»¥ä¾¿æ“ä½œçš„ä¸åŒå¼ é‡å…·æœ‰ç›¸åŒçš„å½¢çŠ¶;<br />
</li>
<li>å¯¹ç”Ÿæˆçš„æ•°ç»„æ‰§è¡ŒæŒ‰å…ƒç´ æ“ä½œ</li>
</ol>
<p>ä¾‹å¦‚ï¼Œaå’Œbåˆ†åˆ«æ˜¯3 Ã— 1å’Œ1 Ã— 2çŸ©é˜µï¼Œå¹¿æ’­ä¼šæˆä¸ºä¸€ä¸ªæ›´å¤§çš„3 Ã— 2çŸ©é˜µ:çŸ©é˜µaå°†å¤åˆ¶åˆ—,çŸ©é˜µbå°†å¤åˆ¶è¡Œ,ç„¶åå†æŒ‰å…ƒç´ ç›¸åŠ  å¹¿æ’­æœºåˆ¶æœ‰ä¸€äº›å®ç”¨çš„æŠ€å·§:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">A = torch.arange(<span class="number">20</span>, dtype=torch.float32).reshape(<span class="number">5</span>, <span class="number">4</span>) </span><br><span class="line">sum_A = A.<span class="built_in">sum</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">A / sum_A <span class="comment">#sum_Aæ²¡æœ‰é™ç»´ï¼Œä»ç„¶æ˜¯ä¸ªçŸ©é˜µï¼Œå¯ä»¥é€šè¿‡å¹¿æ’­å°†Aé™¤ä»¥sum_Aã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ç»“æœå¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="string">tensor([[0.0000, 0.1667, 0.3333, 0.5000],  </span></span><br><span class="line"><span class="string">        [0.1818, 0.2273, 0.2727, 0.3182],</span></span><br><span class="line"><span class="string">        [0.2105, 0.2368, 0.2632, 0.2895],  </span></span><br><span class="line"><span class="string">        [0.2222, 0.2407, 0.2593, 0.2778],  </span></span><br><span class="line"><span class="string">        [0.2286, 0.2429, 0.2571, 0.2714]])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">è¿™æ˜¯ä¸€ç§å¾ˆæ–¹ä¾¿çš„å½’ä¸€åŒ–æ“ä½œ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="åŸºç¡€è®­ç»ƒæ–¹æ³•ç¤ºä¾‹">åŸºç¡€è®­ç»ƒæ–¹æ³•ç¤ºä¾‹</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_array</span>(<span class="params">data_arrays, batch_size, is_train=<span class="literal">True</span></span>):  <span class="comment">#@save</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ„é€ ä¸€ä¸ªPyTorchæ•°æ®è¿­ä»£å™¨&quot;&quot;&quot;</span></span><br><span class="line">    dataset = data.TensorDataset(*data_arrays)</span><br><span class="line">    <span class="keyword">return</span> data.DataLoader(dataset, batch_size, shuffle=is_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">batch_size = <span class="number">10</span></span><br><span class="line">data_iter = load_array((features, labels), batch_size)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>iter</code>æ„é€ Pythonè¿­ä»£å™¨ï¼Œå¹¶ä½¿ç”¨<code>next</code>ä»è¿­ä»£å™¨ä¸­è·å–ç¬¬ä¸€é¡¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">next</span>(<span class="built_in">iter</span>(data_iter))</span><br></pre></td></tr></table></figure>
<pre><code>[tensor([[-0.0714, -1.8597],
         [-0.4744,  0.4050],
         [ 0.2402,  0.5660],
         [ 1.6367, -0.9899],
         [ 0.6723,  0.1904],
         [ 0.5322, -0.4337],
         [-0.5749,  0.6719],
         [-0.0317,  1.3456],
         [ 1.0865, -1.3968],
         [-0.0130, -0.9245]]),
 tensor([[10.3747],
         [ 1.8749],
         [ 2.7762],
         [10.8325],
         [ 4.9005],
         [ 6.7224],
         [ 0.7743],
         [-0.4169],
         [11.1058],
         [ 7.3157]])]</code></pre>
<p><code>Sequential</code>ç±»å°†å¤šä¸ªå±‚ä¸²è”åœ¨ä¸€èµ·,å¹¶è‡ªåŠ¨è®©å…¶å‰å‘ä¼ æ’­<br />
åœ¨PyTorchä¸­ï¼Œå…¨è¿æ¥å±‚åœ¨<code>Linear</code>ç±»ä¸­å®šä¹‰ã€‚<br />
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªå‚æ•°ä¼ é€’åˆ°<code>nn.Linear</code>ä¸­ï¼Œç¬¬ä¸€ä¸ªæŒ‡å®šè¾“å…¥ç‰¹å¾å½¢çŠ¶ï¼Œå³2ï¼Œç¬¬äºŒä¸ªæŒ‡å®šè¾“å‡ºç‰¹å¾å½¢çŠ¶ï¼Œè¾“å‡ºç‰¹å¾å½¢çŠ¶ä¸ºå•ä¸ªæ ‡é‡ï¼Œå› æ­¤ä¸º1ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nnæ˜¯ç¥ç»ç½‘ç»œçš„ç¼©å†™</span></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> nn</span><br><span class="line"></span><br><span class="line">net = nn.Sequential(nn.Linear(<span class="number">2</span>, <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ç›´æ¥è®¿é—®å‚æ•°ä»¥è®¾å®šå®ƒä»¬çš„åˆå§‹å€¼ï¼Œå¦‚é€šè¿‡<code>net[0]</code>é€‰æ‹©ç½‘ç»œä¸­çš„ç¬¬ä¸€ä¸ªå›¾å±‚ï¼Œç„¶åä½¿ç”¨<code>weight.data</code>å’Œ<code>bias.data</code>æ–¹æ³•è®¿é—®å‚æ•°ã€‚<br />
æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ›¿æ¢æ–¹æ³•<code>normal_</code>å’Œ<code>fill_</code>æ¥é‡å†™å‚æ•°å€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net[<span class="number">0</span>].weight.data.normal_(<span class="number">0</span>, <span class="number">0.01</span>)</span><br><span class="line">net[<span class="number">0</span>].bias.data.fill_(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>æŸå¤±å‡½æ•°ä¸ä¼˜åŒ–ç®—æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">loss = nn.MSELoss()</span><br><span class="line">trainer = torch.optim.SGD(net.parameters(), lr=<span class="number">0.03</span>)<span class="comment">#ä½¿ç”¨å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¼˜åŒ–å¯¹è±¡ï¼Œlråˆ™æ˜¯å­¦ä¹ ç‡</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è®­ç»ƒï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">num_epochs = <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> X, y <span class="keyword">in</span> data_iter:</span><br><span class="line">        l = loss(net(X) ,y)</span><br><span class="line">        trainer.zero_grad()</span><br><span class="line">        l.backward()</span><br><span class="line">        trainer.step()</span><br><span class="line">    l = loss(net(features), labels)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;epoch <span class="subst">&#123;epoch + <span class="number">1</span>&#125;</span>, loss <span class="subst">&#123;l:f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>epoch 1, loss 0.000247
epoch 2, loss 0.000110
epoch 3, loss 0.000110</code></pre>
<p>æ¯”è¾ƒç”Ÿæˆæ•°æ®é›†çš„çœŸå®å‚æ•°å’Œé€šè¿‡æœ‰é™æ•°æ®è®­ç»ƒè·å¾—çš„æ¨¡å‹å‚æ•°<br />
è¦è®¿é—®å‚æ•°ï¼Œæˆ‘ä»¬é¦–å…ˆä»<code>net</code>è®¿é—®æ‰€éœ€çš„å±‚ï¼Œç„¶åè¯»å–è¯¥å±‚çš„æƒé‡å’Œåç½®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">w = net[<span class="number">0</span>].weight.data</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;wçš„ä¼°è®¡è¯¯å·®ï¼š&#x27;</span>, true_w - w.reshape(true_w.shape))</span><br><span class="line">b = net[<span class="number">0</span>].bias.data</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;bçš„ä¼°è®¡è¯¯å·®ï¼š&#x27;</span>, true_b - b)</span><br></pre></td></tr></table></figure>
<pre><code>wçš„ä¼°è®¡è¯¯å·®ï¼š tensor([0.0005, 0.0006])
bçš„ä¼°è®¡è¯¯å·®ï¼š tensor([0.0006])</code></pre>
<h2 id="çº¿æ€§æ¨¡å‹">çº¿æ€§æ¨¡å‹</h2>
<p>å›å½’é—®é¢˜å¸¸å¸¸ç”¨è‹¥å¹²è¾“å…¥äº§ç”Ÿä¸€ä¸ªè¿ç»­å€¼ä½œä¸ºè¾“å‡ºï¼Œçº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰å’Œé€»è¾‘å›å½’ï¼ˆLogistics Regressionï¼‰æ˜¯å¸¸è§çš„çº¿æ€§æ¨¡å‹</p>
<h3 id="çº¿æ€§å›å½’">çº¿æ€§å›å½’</h3>
<p>çº¿æ€§å›å½’ï¼Œå³y = wx + b ,æ˜¯æœ€ç®€å•çš„å›å½’æ¨¡å‹ï¼Œä½†çº¯ä¸€æ¬¡é¡¹çš„æ‹Ÿåˆèƒ½åŠ›è¾ƒä¸ºå—é™ï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦å¤šé¡¹å¼å›å½’<br />
æˆ‘ä»¬å°†wè§†ä¸ºæƒå€¼å‘é‡ï¼Œxè§†ä¸ºä»ä¸€æ¬¡x'åˆ°næ¬¡x'ç»„æˆçš„å‘é‡ï¼Œé‚£ä¹ˆå¤šé¡¹å¼æ¨¡å‹ä¾æ—§å¯ä»¥ç”¨åŸå…ˆçš„çº¿æ€§å…¬å¼è¡¨ç¤º<br />
å¢åŠ å¤šé¡¹å¼çš„æ¬¡æ•°å¯ä»¥æ›´å¥½æ‹Ÿåˆè®­ç»ƒé›†ï¼Œä½†å¯¹æµ‹è¯•é›†çš„æ•ˆæœå°±æœªå¿…äº†ï¼Œå¾ˆå®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆé—®é¢˜,å¦‚æœå‡ºç°ï¼Œä¾æ—§éœ€è¦æ­£åˆ™åŒ–ï¼Œå¢åŠ æ•°æ®æ•°é‡æˆ–è€…ç»´åº¦ç­‰ä¼˜åŒ– çº¿æ€§æ¨¡å‹ä¼˜åŒ–æ˜¯ä¸ªçº¯ç²¹çš„æ•°å­¦é—®é¢˜ï¼Œå…¶è§£æè§£åœ¨çº¿ä»£è¯¾ä¸Šå°±ä¼šè®²åˆ°ï¼Œå³ï¼š</p>
<p><span class="math display">\[\mathbf{w}^{*}=(\mathbf{X}^{\mathsf{T}}\mathbf{X})^{-1}\mathbf{X}^{\mathsf{T}}\mathbf{y}.\]</span></p>
<h4 id="pythonå®ç°">pythonå®ç°</h4>
<p>æ±‚æ¢¯åº¦æ›´åƒä¸€ä¸ªæ•°å­¦é—®é¢˜ï¼Œè¿™é‡Œå°±ç”¨pytorchçš„è‡ªåŠ¨æ±‚å¯¼åŠŸèƒ½ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥è‡ªå·±é€šè¿‡è®¡ç®—å›¾å®ç°<br />
ç®€å•ç”Ÿæˆä¸€ä¸ªæœ‰å™ªå£°é¡¹ <span class="math inline">\(\epsilon\)</span> çš„æ•°æ®é›†ï¼Œå™ªå£°é¡¹æœ‰æ ‡å‡†å·®0.01,å‡å€¼ä¸º0çš„æ­£æ€åˆ†å¸ƒç”Ÿæˆ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">synthetic_data</span>(<span class="params">w, b, num_examples</span>):  <span class="comment">#@save</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”Ÿæˆy=Xw+b+å™ªå£°&quot;&quot;&quot;</span></span><br><span class="line">    X = torch.normal(<span class="number">0</span>, <span class="number">1</span>, (num_examples, <span class="built_in">len</span>(w)))æ ¹æ®æ­£æ€åˆ†å¸ƒéšæœºè®¡ç®—åˆå§‹æƒå€¼å‘é‡</span><br><span class="line">    y = torch.matmul(X, w) + b</span><br><span class="line">    y += torch.normal(<span class="number">0</span>, <span class="number">0.01</span>, y.shape)</span><br><span class="line">    <span class="keyword">return</span> X, y.reshape(-<span class="number">1</span>,<span class="number">1</span>)<span class="comment">#-1è¡¨ç¤ºä¸å›ºå®šå½¢çŠ¶ï¼Œæ ¹æ®æ€»å…ƒç´ æ•°å’Œå…¶ä»–ç»´åº¦æ•°é‡è®¡ç®—è¯¥ç»´åº¦</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">true_w = torch.tensor([<span class="number">2</span>, -<span class="number">3.4</span>])<span class="comment">#wå½¢çŠ¶ä¸featureså•è¡Œçš„å½¢çŠ¶ç›¸åŒ</span></span><br><span class="line">true_b = <span class="number">4.2</span></span><br><span class="line">features, labels = synthetic_data(true_w, true_b, <span class="number">1000</span>)<span class="comment">#labelsè¢«reshapeä¸ºå•åˆ—çš„å‘é‡</span></span><br><span class="line">labels.shape</span><br></pre></td></tr></table></figure>
<pre><code>torch.Size([1000])</code></pre>
<p>é€šè¿‡ç”Ÿæˆç¬¬äºŒä¸ªç‰¹å¾<code>features[:, 1]</code>å’Œ<code>labels</code>çš„æ•£ç‚¹å›¾ï¼Œ å¯ä»¥ç›´è§‚è§‚å¯Ÿåˆ°ä¸¤è€…ä¹‹é—´çš„çº¿æ€§å…³ç³»ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d2l.set_figsize()<span class="comment">#æ§åˆ¶å›¾åƒå¤§å°</span></span><br><span class="line">d2l.plt.scatter(features[:, <span class="number">1</span>].detach().numpy(), labels.detach().numpy(), <span class="number">1</span>);<span class="comment">#detach() ç”¨äºä»è®¡ç®—å›¾ä¸­åˆ†ç¦»å¼ é‡</span></span><br></pre></td></tr></table></figure>
<figure>
<img src="/assets/ml/output_8_0.svg" alt="" /><figcaption>svg</figcaption>
</figure>
<p>ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè®¾ç½®ä¸€ä¸ªåˆ’åˆ†å°æ‰¹é‡çš„å·¥å…·å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">data_iter</span>(<span class="params">batch_size, features, labels</span>):</span><br><span class="line">    num_examples = <span class="built_in">len</span>(features)</span><br><span class="line">    indices = <span class="built_in">list</span>(<span class="built_in">range</span>(num_examples))</span><br><span class="line">    <span class="comment"># è¿™äº›æ ·æœ¬æ˜¯éšæœºè¯»å–çš„ï¼Œæ²¡æœ‰ç‰¹å®šçš„é¡ºåº</span></span><br><span class="line">    random.shuffle(indices)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, num_examples, batch_size):</span><br><span class="line">        batch_indices = torch.tensor(</span><br><span class="line">            indices[i: <span class="built_in">min</span>(i + batch_size, num_examples)])</span><br><span class="line">        <span class="keyword">yield</span> features[batch_indices], labels[batch_indices]</span><br></pre></td></tr></table></figure>
<p>å®šä¹‰æ¨¡å‹ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">linreg</span>(<span class="params">X, w, b</span>): </span><br><span class="line">    <span class="string">&quot;&quot;&quot;çº¿æ€§å›å½’æ¨¡å‹&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> torch.matmul(X, w) + b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">squared_loss</span>(<span class="params">y_hat, y</span>): </span><br><span class="line">    <span class="string">&quot;&quot;&quot;å‡æ–¹æŸå¤±&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> (y_hat - y.reshape(y_hat.shape)) ** <span class="number">2</span> / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sgd</span>(<span class="params">params, lr, batch_size</span>):  </span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        <span class="keyword">for</span> param <span class="keyword">in</span> params:</span><br><span class="line">            param -= lr * param.grad / batch_size</span><br><span class="line">            param.grad.zero_()</span><br><span class="line"></span><br><span class="line">w = torch.normal(<span class="number">0</span>, <span class="number">0.01</span>, size=(<span class="number">2</span>,<span class="number">1</span>), requires_grad=<span class="literal">True</span>)</span><br><span class="line">b = torch.zeros(<span class="number">1</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line">lr = <span class="number">0.03</span></span><br><span class="line">num_epochs = <span class="number">3</span></span><br><span class="line">net = linreg</span><br><span class="line">loss = squared_loss</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):    <span class="keyword">for</span> X, y <span class="keyword">in</span> data_iter(batch_size, features, labels):</span><br><span class="line">        l = loss(net(X, w, b), y)  <span class="comment"># Xå’Œyçš„å°æ‰¹é‡æŸå¤±</span></span><br><span class="line">        <span class="comment"># å› ä¸ºlå½¢çŠ¶æ˜¯(batch_size,1)ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ ‡é‡ã€‚lä¸­çš„æ‰€æœ‰å…ƒç´ è¢«åŠ åˆ°ä¸€èµ·ï¼Œ å¹¶ä»¥æ­¤è®¡ç®—å…³äº[w,b]çš„æ¢¯åº¦</span></span><br><span class="line">        l.<span class="built_in">sum</span>().backward()</span><br><span class="line">        sgd([w, b], lr, batch_size)  <span class="comment"># ä½¿ç”¨å‚æ•°çš„æ¢¯åº¦æ›´æ–°å‚æ•°</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        train_l = loss(net(features, w, b), labels)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;epoch <span class="subst">&#123;epoch + <span class="number">1</span>&#125;</span>, loss <span class="subst">&#123;<span class="built_in">float</span>(train_l.mean()):f&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>epoch 1, loss 0.030660
epoch 2, loss 0.000105
epoch 3, loss 0.000046</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;wçš„ä¼°è®¡è¯¯å·®: <span class="subst">&#123;true_w - w.reshape(true_w.shape)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;bçš„ä¼°è®¡è¯¯å·®: <span class="subst">&#123;true_b - b&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>wçš„ä¼°è®¡è¯¯å·®: tensor([ 0.0001, -0.0006], grad_fn=&lt;SubBackward0&gt;)
bçš„ä¼°è®¡è¯¯å·®: tensor([0.0004], grad_fn=&lt;RsubBackward1&gt;)</code></pre>
<h3 id="åˆ†ç±»">åˆ†ç±»</h3>
<p>åˆ†ç±»é—®é¢˜æœ€ç®€å•çš„è§£å†³æ–¹æ³•è«è¿‡äºå¯¹å›å½’äº§ç”Ÿçš„ç»“æœè¿›è¡Œç­›é€‰ï¼Œä¸€ä¸ªåŒºé—´å¯¹åº”ä¸€ä¸ªç±»åˆ«ï¼Œä½†è¿™ä¹ˆåšä¼šå¾ˆéš¾å¤„ç†åŒºé—´çš„åˆ’åˆ†æƒ…å†µï¼Œå› æ­¤éœ€è¦å…¶ä»–çš„å¤„ç†æ–¹æ³•<br />
åˆ†ç±»é—®é¢˜çš„æŸå¤±å‡½æ•°ä¸å›å½’ä¸åŒï¼Œå¯ä»¥å•çº¯ç”¨åˆ†ç±»é”™è¯¯ç‡è®¡ç®—ï¼Œå¸¸ç”¨æ¨¡å‹æœ‰æ„ŸçŸ¥æœºã€æ”¯æŒå‘é‡æœºç­‰</p>
<h4 id="æ„ŸçŸ¥æœº">æ„ŸçŸ¥æœº</h4>
<p>æ„ŸçŸ¥æœºæ¥æ”¶å¤šä¸ªè¾“å…¥ä¿¡å·,æ ¹æ®æƒé‡è¾“å‡ºä¸€ä¸ªä¿¡å·ï¼Œä¾‹å¦‚0å’Œ1<br />
å¦‚æœæˆ‘ä»¬ç”¨æœ€ç®€å•çš„æ„ŸçŸ¥æœº(ä¾æ—§è¾“å‡ºä¸€ä¸ªè¿ç»­å€¼ï¼Œé€šè¿‡æ¿€æ´»å‡½æ•°äº§ç”Ÿåˆ†ç±»)ï¼Œé‚£ä¹ˆåˆ†ç±»ä»»åŠ¡çš„é‡ç‚¹å°±æ˜¯æ‰¾çš„ä¸€ä¸ªåˆé€‚çš„é—¨æ§›å€¼threshold<br />
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ„ŸçŸ¥æœºæœ¬è´¨ä¸Šæ˜¯ä¸ªçº¿æ€§çš„ç•Œé™ï¼Œé€šè¿‡æƒé‡å‘é‡å’Œåç½®å€¼åˆ’åˆ†ä¸åŒçš„è¾“å…¥ï¼Œè®¾æƒ³è¿™æ ·çš„æƒ…å†µï¼š</p>
<ol type="1">
<li>æœ‰å¤šç§è¾“å…¥éœ€è¦åˆ†æˆä¸¤ç±»</li>
<li>å…¶ä¸­ä¸€ç±»æœ‰ä¸¤ä¸ªè¾“å…¥è¿æˆç›´çº¿L1,å¦ä¸€ç±»ä¸­æœ‰ä¸¤ä¸ªè¾“å…¥å¯ä»¥è¿æˆç›´çº¿L2</li>
<li>å¦‚æœL1å’ŒL2ç›¸äº¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸å¯èƒ½åœ¨ä¸­é—´ç”»ä¸€æ¡çº¿æŠŠä¸¤ä¸ªç›´çº¿åˆ†å¼€(è¯æ˜å°±ä¸ç®¡äº†)</li>
</ol>
<p>äº‹å®ä¸Šï¼Œä¾‹å¦‚å¼‚æˆ–é—¨å°±æ— æ³•é€šè¿‡æ„ŸçŸ¥æœºå®ç°ï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ†å¼€(1,0)(0,1)ä»¥åŠ(0,0)(1,1)ï¼Œè¿™ä¸¤ç±»çš„è¿çº¿ç›¸äº¤ï¼Œå‡†ç¡®åœ°è¯´ï¼Œè¿™æ˜¯è¯´å•å±‚æ„ŸçŸ¥æœºï¼Œå› ä¸ºæ›²çº¿å°±å¯ä»¥åˆ’åˆ†è¿™ä¸¤ç±»ï¼Œä¹Ÿå°±æ˜¯â€œ<strong>å•å±‚æ„ŸçŸ¥æœºæ— æ³•åˆ†ç¦»éçº¿æ€§ç©ºé—´</strong>â€<br />
ä¾‹å¦‚ï¼Œå¯¹å¼‚æˆ–é—¨è¿™ä¸ªé—®é¢˜ã€‚åŠ ä¸€å±‚ç¥ç»å°±èƒ½å°†åˆ†ç•Œçº¿æ‹“å±•ä¸ºæŠ›ç‰©çº¿ï¼Œä¹Ÿå°±æ˜¯æ¬¡æ•°+1ï¼Œè¿™æ ·å°±èƒ½è¿›è¡Œéçº¿æ€§åˆ’åˆ†(å¤šå±‚æ„ŸçŸ¥æœº) æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŠ ä¸€å±‚featureè½¬åŒ–å±‚ï¼Œå°†åŸæ¥çš„xæ˜ å°„ä¸ºå¯ä»¥è¢«çº¿æ€§åˆ’åˆ†çš„x'</p>
<div class="note info"><p>pythonä¸­å®šä¹‰é˜¶è·ƒå‡½æ•°(è¾“å…¥è¶…è¿‡é˜ˆå€¼,å°±åˆ‡æ¢è¾“å‡º):</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_function</span>(<span class="params">x</span>): </span><br><span class="line">    y=x&gt;<span class="number">0</span> <span class="keyword">return</span> <span class="comment">#äº§ç”Ÿboolæ•°ç»„</span></span><br><span class="line">    y.astype(np.<span class="built_in">int</span>) <span class="comment"># å°†boolæ•°ç»„è½¬æ¢ä¸º1ä¸0çš„intæ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step_function</span>(<span class="params">x</span>): </span><br><span class="line">    <span class="keyword">return</span> np.array(x &gt; <span class="number">0</span>, dtype=np.<span class="built_in">int</span>) </span><br><span class="line"></span><br><span class="line">x = np.arange(-<span class="number">5.0</span>, <span class="number">5.0</span>, <span class="number">0.1</span>) </span><br><span class="line">y = step_function(x) </span><br><span class="line">plt.plot(x, y) </span><br><span class="line">plt.ylim(-<span class="number">0.1</span>, <span class="number">1.1</span>) <span class="comment"># æŒ‡å®š y è½´çš„èŒƒå›´ </span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div>
<h4 id="é€»è¾‘å›å½’discriminative-model">é€»è¾‘å›å½’(discriminative model)</h4>
<p>é€»è¾‘å›å½’çš„ç›®æ ‡æ˜¯é¢„æµ‹ä¸€ä¸ªäºŒå…ƒå˜é‡ï¼ˆä¾‹å¦‚ï¼Œ0æˆ–1ã€æ˜¯æˆ–å¦ï¼‰ã€‚é€šè¿‡é€»è¾‘å‡½æ•°ï¼ˆsigmoid å‡½æ•°ï¼‰å°†çº¿æ€§ç»„åˆçš„è¾“å…¥è½¬æ¢ä¸ºæ¦‚ç‡å€¼<br />
ç›¸æ¯”çº¿æ€§å›å½’ï¼Œå…¶æœ€å¤§çš„ç‰¹ç‚¹æ˜¯è¾“å‡ºåœ¨0-1ä¹‹é—´ï¼Œå¯ä»¥ç†è§£ä¸ºæ¦‚ç‡ï¼Œä¸€èˆ¬ç”¨äºå¤„ç†åˆ†ç±»ï¼ˆäºŒåˆ†ï¼‰é—®é¢˜</p>
<p>ç»è¿‡ç®€å•ï¼ˆå¹¶ä¸ï¼‰çš„æ¢¯åº¦è¿ç®—ï¼Œå¯ä»¥å¾—åˆ°å¸¸ç”¨losså‡½æ•°çš„æ¢¯åº¦ä¸ºï¼š</p>
<ol type="1">
<li>äº¤å‰ç†µ: <span class="math inline">\(\sum_{n}-{\bigg(}{ {\hat{y}^{n}-f_{w,b}(x^{n})} { } } {\bigg)}x_{i}^{n}\)</span></li>
<li>å‡æ–¹æ ¹: <span class="math inline">\(2(f_{w,b}(x)-\hat{y})f_{w,b}(x)\left(1-f_{w,b}(x)\right)x_{i}\)</span></li>
</ol>
<p>è¿™æ ·ä¸€æ¥å°±æœ‰ä¸ªé—®é¢˜ï¼Œå‡æ–¹æ ¹çš„æ¢¯åº¦åœ¨æŸå¤±è¾ƒå¤§å’Œè¾ƒå°æ—¶éƒ½å¾ˆå°ï¼Œåªæœ‰äº¤å‰ç†µç¬¦åˆè¿œæ›´æ–°å¿«è¿‘æ›´æ–°æ…¢çš„æ¡ä»¶</p>
<h4 id="åŸºäºæ¦‚ç‡çš„åˆ†ç±»æ–¹æ³•generative-model">åŸºäºæ¦‚ç‡çš„åˆ†ç±»æ–¹æ³•(generative model)</h4>
<p>å¦‚æœæœ‰ä¸¤ä¸ªç±»c1,c2ç”¨äºåˆ†ç±»ï¼ŒæŠ½åˆ°ä¸€ä¸ªæ ·æœ¬x,è¿™å°±åƒé«˜ä¸­æ•°å­¦åœ°æŠ½å°çƒé—®é¢˜ï¼ŒéšæœºæŠ½ä¸ªæ ·æœ¬æ˜¯æŸç±»å°çƒçš„æ¦‚ç‡å–å†³äºåœ¨æŠ½å–çš„é»‘ç›’å­é‡Œä¸åŒç±»åˆ«çš„åˆ†å¸ƒã€‚<br />
æ­¤æ—¶æˆ‘ä»¬çš„ç›®çš„æ˜¯æ ¹æ®å‚æ•°é¢„æµ‹åˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒç±»åˆ«çš„åˆ†å¸ƒåªèƒ½çŒœæƒ³ï¼Œäºæ˜¯å‡è®¾åœ¨æœ€ç®€å•çš„ä¸¤ä¸ªå‚æ•°æƒ…å†µä¸‹ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°æ»¡è¶³åŸºäºè¿™ä¸¤ä¸ªå‚æ•°çš„é«˜æ–¯(æ­£æ€)åˆ†å¸ƒï¼Œè®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ†åˆ«é€šè¿‡æ ·æœ¬å¾—åˆ°ä¸¤ç±»å„è‡ªçš„åˆ†å¸ƒæƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œåæ–¹å·®çŸ©é˜µ</p>
<div class="note info"><p>æå¤§ä¼¼ç„¶ä¼°è®¡å¯ä»¥ç†è§£ä¸ºåˆ©ç”¨å·²çŸ¥çš„æ ·æœ¬ç»“æœä¿¡æ¯ï¼Œåæ¨æœ€å…·æœ‰å¯èƒ½ï¼ˆæœ€å¤§æ¦‚ç‡ï¼‰å¯¼è‡´è¿™äº›æ ·æœ¬ç»“æœå‡ºç°çš„æ¨¡å‹å‚æ•°å€¼ï¼Œä¾‹å¦‚æŠ½çƒ(æ”¾å›å¼)é—®é¢˜ä¸­æŠ½ä¸€ç™¾æ¬¡ï¼Œä¸ƒåæ¬¡æ˜¯ç™½çƒ,ä¸‰åæ¬¡ä¸ºé»‘çƒï¼Œè‹¥æŠ½åˆ°ç™½çƒçš„æ¦‚ç‡æ˜¯pï¼Œè¿™ä¸ªç»“æœçš„æ¦‚ç‡æ˜¯p<sup>70(1-p)</sup>30ï¼Œç¬¦åˆç›´è§‰çš„çŒœæƒ³æ˜¯p=0.7ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä¸‹æ„è¯†ç”¨äº†æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚<br />
è¦ä»¤å‡ºç°æ­¤æƒ…å†µçš„æ¦‚ç‡æœ€å¤§ï¼Œåªéœ€è¦æ±‚å¯¼ç®—ä¸€æ¬¡æå€¼å°±ä¼šå¾—åˆ°p=0.7ï¼Œç”±æ­¤äº§ç”Ÿäº†ä¸€ä¸ªä¼°è®¡</p>
</div>
<p>ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡ï¼Œç±»ä¼¼æŠ½çƒé—®é¢˜ï¼Œå¾—åˆ°ç›®å‰ç»“æœçš„æ¦‚ç‡å…¶å®ç»“æœæ‰€æœ‰å–æ ·ç‚¹æ¦‚ç‡çš„ç§¯ï¼Œçœç•¥æ€ä¹ˆè®¡ç®—ï¼Œæœ€åæˆ‘ä»¬èƒ½å¾—åˆ°ä¸¤ç»„(Î¼, âˆ‘)<br />
æ­¤æ—¶æ¨¡å‹ç¡®å®šäº†ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°P(x|Ci), i = 1, 2ï¼Œè¿™æ˜¯ç§å…ˆéªŒæ¦‚ç‡ï¼ˆPrior Probabilityï¼‰ï¼Œé€šè¿‡è´å¶æ–¯å…¬å¼å°±èƒ½ç®—å‡ºåéªŒæ¦‚ç‡ï¼ˆPosterior Probabilityï¼‰ï¼šP(Ci|x)</p>
<p><span class="math display">\[ P(A | B) = \frac{P(B | A) \cdot P(A)}{P(B)} \]</span></p>
<p>è¿™ä¹ˆä¸€æ¥ï¼Œåˆ†ç±»å°±å¯ä»¥æ ¹æ®æœ€å¤§åéªŒæ¦‚ç‡å¯¹åº”çš„ç§ç±»æ¥é€‰<br />
ä¼˜åŒ–ï¼š<br />
ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆå¯ä»¥ç»Ÿä¸€âˆ‘ï¼Œæ¨¡å‹æ¦‚ç‡å˜ä¸ºï¼š <span class="math display">\[\operatorname{L}(u^{1},\vert u^{2},\Sigma)=\prod_{i=1}^{79}f_{\mu^{1},\Sigma}(x^{i})\times\prod_{j=1}^{61}f_{\mu^{2},\Sigma}(x^{79+j})\]</span></p>
<p>åæ–¹å·®çŸ©é˜µå¯ä»¥ç›´æ¥æŒ‰æ ·æœ¬æ•°é‡åŠ æƒå’Œ<br />
ç»Ÿä¸€åæ–¹å·®çŸ©é˜µåï¼Œå…¶å®å¦‚æœè¿›è¡ŒåŒ–ç®€ä¼šå‘ç°æ­¤æ—¶ä¾æ—§æ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œå³wx+bå½¢å¼çš„æ¨¡å‹</p>
<div class="note info"><p>åœ¨ç»Ÿè®¡å­¦ä¸­ï¼Œæ–¹å·®æ˜¯ç”¨æ¥åº¦é‡å•ä¸ªéšæœºå˜é‡çš„ç¦»æ•£ç¨‹åº¦ï¼Œè€Œåæ–¹å·®åˆ™ä¸€èˆ¬ç”¨æ¥åˆ»ç”»ä¸¤ä¸ªéšæœºå˜é‡çš„ç›¸ä¼¼ç¨‹åº¦<br />
<img src="https://www.zhihu.com/equation?tex=%5Csigma_x%5E2%3D%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi%3D1%7D%5En%5Cleft%28x_i-%5Cbar%7Bx%7D%5Cright%29%5E2&amp;consumer=ZHI_MENG" /> <img src="https://www.zhihu.com/equation?tex=%5Csigma%5Cleft%28x%2Cy%5Cright%29%3D%5Cfrac%7B1%7D%7Bn-1%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%5Cleft%28x_i-%5Cbar%7Bx%7D%5Cright%29%5Cleft%28y_i-%5Cbar%7By%7D%5Cright%29&amp;consumer=ZHI_MENG" /></p>
</div>
<p>ä»¥ä¸Šä¸¤ç§modelï¼Œå…¶å®é€»è¾‘å›å½’çš„å‡†ç¡®ç‡åœ¨å®å¯æ¢¦æ•°æ®é›†ä¸Šç•¥å¥½äºæ¦‚ç‡åˆ†å¸ƒï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºæ¦‚ç‡æ¨¡å‹ä¼šé¢„å…ˆå‡è®¾æ•°æ®ç¬¦åˆä¸€ç§æ¦‚ç‡åˆ†å¸ƒï¼Œå› æ­¤æ¦‚ç‡æ¨¡å‹ç›¸å¯¹æ›´é€‚åˆæ¨¡å‹æ•°é‡å°‘æˆ–è€…æœ‰ä¸€å®šnoiseçš„æƒ…å†µ</p>
<h4 id="softmax">softmax</h4>
<p>å‰ä¸¤ä¸ªæ¨¡å‹è€ƒè™‘äº†äºŒåˆ†çš„æƒ…å†µï¼Œé‚£ä¹ˆå¤šä¸ªç±»åˆ«å‘¢ï¼Ÿè¿™æ—¶ä»ç„¶éœ€è¦æ¨¡å‹è¾“å‡ºæ¦‚ç‡ï¼Œä½†æ˜¯æ¦‚ç‡æ€»å’Œéœ€è¦å°äºç­‰äº1ï¼Œç„¶åé€‰ä¸€ä¸ªæœ€é«˜çš„ä½œä¸ºè¾“å‡ºï¼›é—®é¢˜å˜æˆäº†å¦‚ä½•å¾—åˆ°è¿™æ ·çš„æ¦‚ç‡ï¼Œå¯ä»¥ç”¨<strong>softmax</strong><br />
å¯¹æ¯ä¸ªè¾“å‡ºå€¼ <span class="math inline">\(o_j\)</span> é¢„æµ‹æ¦‚ç‡å€¼ <span class="math inline">\(\hat y_j\)</span> å¯ä»¥è¿™ä¹ˆå¾—åˆ°ï¼š<br />
<span class="math display">\[ {\hat{y} }_{j}={\frac{\exp(o_{j})}{\sum_{k}\exp(o_{k})} } \]</span><br />
<span class="math inline">\(\hat y_j\)</span> å¯ä»¥è§†ä¸ºå¯¹ç»™å®šä»»æ„è¾“å…¥xçš„æ¯ä¸ªç±»çš„æ¡ä»¶æ¦‚ç‡ï¼Œå³P(y = æŸç±» | x)<br />
æ•´ä¸ªæ•°æ®é›†çš„æ¡ä»¶æ¦‚ç‡ä¸ºï¼š<br />
<span class="math display">\[P({\bf Y}\mid{\bf X})=\prod_{i-1}^{n}P({\bf y}^{(i)}\mid{\bf x}^{(i)}).\]</span><br />
æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡,æˆ‘ä»¬æœ€å¤§åŒ–P(Y|X),ç›¸å½“äºæœ€å°åŒ–æ‰€æœ‰å­æ¦‚ç‡çš„è´Ÿå¯¹æ•°å’Œ<br />
<span class="math display">\[ -\log P(\mathbf{Y}\mid\mathbf{X})=\sum_{i=1}^{n}-\log P(\mathbf{y}^{(i)}\mid\mathbf{x}^{(i)})=\sum_{i=1}^{n}l(\mathbf{y}^{(i)},{\hat{\mathbf{y} } }^{(i)}) \]</span><br />
å…¶ä¸­çš„æŸå¤±å‡½æ•°æ˜¯äº¤å‰ç†µ<br />
<span class="math display">\[l({\bf y},\hat{\bf y})=-\sum_{j=1}^{q}y_{j}\log\hat{y}_{j}.\]</span> 

$$\begin{align}
l({\bf y},\hat{\bf y})=  -\sum_{j=1}^{q}y_{j}\log{\frac{\exp(o_{j})}{\sum_{k=1}^{q}\exp(o_{k})}}   \\ 
=\sum_{j=1}^{q}y_{j}\log\sum_{k=1}^{q}\exp(o_{k})-\sum_{j=1}^{q}y_{j}o_{j} \\
=\log\sum_{k=1}^{q}\exp(o_{k})-\sum_{j=1}^{q}y_{j}o_{j}.

\end{align}$$

$$ \partial_{o_{j}l}({\bf y},\hat{\bf y})=\frac{\exp(o_{j})}{\sum_{k=1}^{q}\exp(o_{k})}-y_{j}=\mathrm{sofmax}({\bf o})_{j}-y_{j} $$

</p>
<p>softmaxæ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°,ä½†softmaxå›å½’çš„è¾“å‡ºä»ç„¶ç”±è¾“å…¥ç‰¹å¾çš„ä»¿å°„å˜æ¢(ä¿æŒç‚¹ã€ç›´çº¿å’Œé¢ä¹‹é—´ç›¸å¯¹å…³ç³»çš„å˜æ¢)å†³å®šï¼Œå› æ­¤,softmaxå›å½’æ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹<br />
çœ‹ä¸Šå»å¾ˆå·§ï¼Œå¯¼æ•°å°±æ˜¯softmaxæ¨¡å‹åˆ†é…çš„æ¦‚ç‡ä¸å®é™…å‘ç”Ÿçš„æƒ…å†µ(ç”±ç‹¬çƒ­æ ‡ç­¾å‘é‡è¡¨ç¤º)ä¹‹é—´çš„å·®å¼‚ <a href="./#åˆ†å¸ƒ">æ•°å­¦åŸç†</a></p>
<h3 id="ä¼˜åŒ–æŠ€å·§">ä¼˜åŒ–æŠ€å·§</h3>
<p>è®­ç»ƒæ•ˆæœå–å†³äºå¾ˆå¤šå› ç´ ï¼Œå¸¸è§çš„æ’æŸ¥æ€è·¯æœ‰ï¼š</p>
<ul>
<li>Model Bias: è®­ç»ƒæ•°æ®æœ‰ä¸€å®šå€¾å‘æ€§ï¼Œå®é™…çš„function setè¿‡äºå°ä»¥è‡´äºæ²¡æœ‰ç†æƒ³çš„å‡½æ•°ï¼Œæ­¤æ—¶å¯èƒ½éœ€è¦å¢åŠ å‚æ•°æˆ–è€…å¢åŠ æ•°æ®é‡</li>
<li>å±€éƒ¨æœ€å°å€¼å’Œéç‚¹: å¯ä»¥ç”¨æ³°å‹’å…¬å¼ä¼°ç®—é™„è¿‘çš„å‡½æ•°å€¼ï¼Œè¿™ä¸¤ç§ç‚¹çš„æ¢¯åº¦(ä¸€é˜¶å¯¼)éƒ½æ˜¯0ï¼ŒåŒºåˆ«åœ¨äºäºŒé˜¶å¯¼æ•°ï¼Œå¦‚æœæ’éæ­£/éè´Ÿï¼Œå°±æ˜¯æå€¼ï¼Œå¦åˆ™å°±æ˜¯éç‚¹
<ul>
<li>ä»¤é™„è¿‘ç‚¹ä¸æ±‚å¯¼çš„ç‚¹ä¹‹é—´çš„å‘é‡ä¸ºv,æ³°å‹’å…¬å¼çš„äºŒé˜¶é¡¹å¯ä»¥å†™æˆ <span class="math inline">\(v^THv\)</span> çš„å½¢å¼(Hæ˜¯å¯¹å„ä¸ªwçš„äºŒé˜¶å¯¼æ•°é¡¹ç»„æˆçš„å¥å­)ï¼Œç”¨çº¿ä»£çš„æŒ‡ç¤ºï¼Œè¯¥å¼æ’éæ­£/éè´Ÿç­‰ä»·äºHçš„ç‰¹å¾å€¼æ’éæ­£/éè´Ÿ
<ul>
<li>è¿™æ ·ä¸€æ¥ï¼Œå¯¹éç‚¹ï¼Œè®¾Hçš„ç‰¹å¾å‘é‡ä¸ºuï¼Œ <span class="math inline">\(u^THu = \lambda||u||^2\)</span> , æ²¿ç€ä¸ºè´Ÿçš„ç‰¹å¾å‘é‡æ–¹å‘å°±èƒ½ç»§ç»­ä¸‹é™</li>
</ul></li>
<li>å¦ä¸€ç§æ€è·¯æ˜¯æ‰€è°“çš„åŠ¨é‡ï¼ŒåŠ¨é‡æœ¬è´¨ä¸Šæ˜¯ä¹‹å‰çš„æ¢¯åº¦çš„åŠ æƒå’Œï¼Œç±»æ¯”ç‰©ç†ä¸Šçš„åŠ¨é‡ï¼Œèƒ½ä¸€å®šç¨‹åº¦ä¸Šä¿æŒè®­ç»ƒæ•´ä½“çš„å€¾å‘,å°†å…¶ä¸å½“å‰æ¢¯åº¦ç›¸åŠ ,èƒ½ä¸€å®šç¨‹åº¦ä¸Šå¸®åŠ©è·³å‡ºå±€éƒ¨æœ€ä½ç‚¹</li>
</ul></li>
<li>æœ‰æ—¶é™æ€çš„æ›´æ–°å¾ˆéš¾è¾¾åˆ°æœ€ä½ç‚¹(æ›´æ–°å¿«ä¼šé‡åˆ°ä¸åŒå‚æ•°æ”¶æ•›é€Ÿåº¦ä¸åŒå¯¼è‡´çš„éœ‡è¡ï¼Œæ…¢ä¼šé¾Ÿé€Ÿçˆ¬è¡Œ)ï¼Œå› æ­¤éœ€è¦åŠ¨æ€çš„æ›´æ–°æœºåˆ¶: <span class="math inline">\(\theta_{i}^{t+1}\leftarrow\theta_{i}^{t}-\frac{\eta}{\sigma_{i}^{t} }\,g_{i}^{t}\)</span> å…¶ä¸­ <span class="math inline">\(\sigma_{i}^{t}=\sqrt{\frac{1}{t+1} \sum_{i=0}^{t}(g_{i}^{t})^{2} }\)</span> <span class="math inline">\(g_{i}^{t}=\frac{\partial L}{\partial\theta_{i}}|_{\theta=\theta^{t}}\)</span> (adagrad)
<ul>
<li>ä½†ä¾ç„¶æœ‰é—®é¢˜: åŒä¸€ä¸ªå‚æ•°åœ¨ä¸åŒçš„å–å€¼èŒƒå›´å†…æ”¶æ•›é€Ÿåº¦ä¹Ÿä¸åŒï¼Œå› æ­¤éœ€è¦è¿›ä¸€æ­¥çš„åŠ¨æ€æœºåˆ¶(RMS Prop): <span class="math inline">\(\theta_{i}^{t+1}\leftarrow\theta_{i}^{t}-\frac{\eta}{\sigma_{i}^{t}}\,g_{i}^{t}\quad\sigma_{i}^{t}=\sqrt{\alpha\!\left(\sigma_{i}^{t-1}\right)^{2}+(1-\alpha)\!\left(g_i^{t}\right)^{2}}\)</span> ä»è€Œè®©æœ€è¿‘çš„æ¢¯åº¦å½±å“æ›´å¤§</li>
<li>è‘—åçš„adamå°±æ˜¯åŒæ—¶ç”¨äº† <code>momentum</code>å’Œ <code>RMS Prop</code>,åŠ¨é‡ä¸ <span class="math inline">\(\sigma\)</span> çš„ä¸åŒæ˜¯: åŠ¨é‡è€ƒè™‘æ–¹å‘,è€Œåè€…åªè€ƒè™‘å¤§å°</li>
</ul></li>
<li>ä¸Šè¿°æ–¹æ³•è¿˜æ˜¯ä¼šæœ‰éœ‡è¡,åªä¸è¿‡éœ‡è¡ä¼šæœ€åæ”¶æ•›,å› æ­¤è€ƒè™‘èƒ½å¦åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡
<ul>
<li>æœ€å¸¸è§çš„åšæ³•æ˜¯å­¦ä¹ ç‡è¡°å‡<code>learning rate decay</code></li>
<li><code>warm up</code>,ä¹Ÿå°±æ˜¯è®©å­¦ä¹ ç‡å…ˆå¿«åæ…¢,å¾ˆéš¾è§£é‡Š,ä½†å…ˆå¿«åæ…¢çš„warmupåœ¨å¾ˆå¤šçŸ¥åæ¨¡å‹é‡Œè¡¨ç°å¾ˆå¥½</li>
</ul></li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´,adamæ¯”SGDM(ä½¿ç”¨åŠ¨é‡çš„sgd)é€Ÿåº¦å¿«,ä½†æœ€åæ”¶æ•›çš„æ•ˆæœå·®ä¸€ç‚¹,è¿™ä¸¤è€…å¯ä»¥è¯´æ˜¯ä¸¤ä¸ªæç«¯,å¸¸ç”¨çš„ä¼˜åŒ–ç­–ç•¥ä¼šåœ¨ä¸¤è€…é—´æŠ˜ä¸­æˆ–è€…å¾®è°ƒ,ä½†å¯è§£é‡Šæ€§å˜›,éƒ½å¾ˆéš¾è¯´ ä»¥ä¸‹ç®€å•çš„è®°å½•ä¸€äº›ç›¸å…³æ–¹æ³•:</p>
<p>adaméƒ¨åˆ†:</p>
<ul>
<li>SWATS: æœ´ç´ çš„æ–¹æ³•,å…ˆç”¨adamå¿«é€Ÿé€¼è¿‘ç›®æ ‡,å†ç”¨sgdmæ…¢æ…¢æ”¶æ•›</li>
<li>AMSGrad: æŸäº›å±€éƒ¨çš„æ¢¯åº¦å¯èƒ½ä¼šè¶…è¿‡å‡ ä¸ªæ•°é‡çº§çš„é«˜,å› ä½†ç”±äºadamç®—çš„æ˜¯å¹³æ–¹å‡æ ¹,è¿™ä¸ªå±€éƒ¨æ¢¯åº¦å½±å“ä¼šéå¸¸æœ‰é™,(ä¾‹å¦‚aæ¯”bå°100å€,å¹³æ–¹æ ¹åªå·®10å€,100ä¸ªaçš„æ¢¯åº¦å´å¤§äºä¸€ä¸ªbçš„æ¢¯åº¦) å› æ­¤å¯ä»¥è®°ä½ä¸€ä¸ªå†å²æœ€å¤§å€¼,ä»è€Œç›¸å¯¹æ‰©å¤§å¤§æ¢¯åº¦çš„å½±å“åŠ›, è¿™æ ·çš„è¯è¿ç»­é‡åˆ°å°æ¢¯åº¦å­¦ä¹ ç‡ä¸ä¼šå‡å°‘, <span class="math inline">\({ {\theta_{t}=\theta_{t-1}-\frac{p}{\sqrt{\hat{v}_{t}+\varepsilon}}m_{t}\space\space } } { {\hat{v}_{t}=\operatorname*{max}(\hat{v}_{t-1},v_{t})} }\)</span> ä½†è¿™å…¶å®æ²¡æœ‰è§£å†³adagradå­¦ä¹ ç‡ä¸æ–­è¡°å‡çš„é—®é¢˜,åªæ˜¯å»¶ç¼“äº†</li>
<li>AdaBound: ç»™learning rateè®¾ç½®ä¸Šä¸‹é™(clipå‡½æ•°),ç®€å•ç²—æš´,å¯è§£é‡Šæ€§ä¹Ÿå¾ˆè¿·</li>
<li>cyclicalLR: è®©lrå‘¨æœŸæ€§æ³¢åŠ¨,ç®€å•çš„çº¿æ€§æ³¢åŠ¨æˆ–è€…coså‡½æ•°éƒ½å¯ä»¥,lrå¤§æ˜¯æ¢ç´¢æ€§çš„,å°æ˜¯å¯»æ‰¾æ”¶æ•›ç‚¹,ç±»ä¼¼çš„æœ‰<code>SGDR</code>,<code>One-cycle LR</code>ç­‰</li>
</ul>
<p>RAdam: ç”¨äºè§£å†³è®­ç»ƒåˆæœŸæ¢¯åº¦æ–¹å·®å¤§,å…ˆç”¨sgdmç§¯ç´¯è¶³å¤Ÿçš„æ ·æœ¬,å†è½¬åˆ°ç±»ä¼¼adamçš„æ–¹æ³•,åŒæ—¶è®©éåˆæœŸçš„æ¢¯åº¦æœ‰æ›´é«˜å½±å“åŠ›<br />
å‡è®¾æ¢¯åº¦æ˜¯å–æ ·äºä¸€ç§åˆ†å¸ƒ,å› æ­¤å‚æ•°åªå’Œå–æ ·æ¬¡æ•°tæœ‰å…³,å­¦ä¹ ç‡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶,å…¶ä¸­rtæ˜¯æ’å¢çš„</p>
<p><span class="math display">\[\begin{array}{c}{ {\rho_{t}=\rho_{\infty}-\frac{2t\beta_{2}^{\ t} }{1-\beta_{2}^{\ 2} } } }\\ { {\rho_{\infty}=\displaystyle\frac{2}{1-\beta_{2}^{\prime} }-1} }\\ r_{t}={\sqrt{\frac{(\rho_{t}-4)(\rho_{t}-2)\rho_{\infty} } {(\rho_{\infty}-4)(\rho_{\infty}-2)\rho_{t} } } } \end{array}\]</span></p>
<p><span class="math display">\[\theta_{t}=\theta_{t-1}-\eta\hat{m}_{t} \space when \space ğœŒğ‘¡ â‰¤ 4\]</span></p>
<p><span class="math display">\[\theta_{t}=\theta_{t-1}-{\frac{\eta r_{t} }{ {\sqrt{\hat{v} }_{t}+\varepsilon} } }\,{\hat{m} }_{t} \space when \space ğœŒğ‘¡ &gt; 4\]</span></p>
<p>è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¿å®ˆçš„ç­–ç•¥,é˜²æ­¢å¤ªè¿‡æ¿€è¿›çš„å­¦ä¹ </p>
<p>åŠ¨é‡ç›¸å…³:</p>
<ul>
<li>Nesterov accelerated gradient (NAG): ä¸æ™®é€šåŠ¨é‡æ³•åŒºåˆ«æ˜¯,ç”¨åŠ¨é‡æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªå‚æ•°ä½ç½®,é€šè¿‡é¢„æµ‹ä½ç½®çš„æ¢¯åº¦æ›´æ–°å‚æ•° <span class="math inline">\(m_{t}={\lambda}m_{t-1}+\eta\nabla L(\theta_{t-1}-\lambda m_{t-1})\)</span></li>
</ul>
<p>å…¶ä»–:</p>
<ul>
<li>Lookahead: ä¸€ç§å¾ˆæŠ½è±¡çš„æ–¹æ³•,ä¸ç®¡ç”¨ä»€ä¹ˆä¼˜åŒ–æ–¹æ³•,æ¯è½®ä¸­èµ°kæ­¥åˆ°ä¸€ä¸ªç†è®ºä¸Šçš„ç»ˆç‚¹,åœ¨èµ·ç‚¹å’Œç»ˆç‚¹é—´æ‰¾ä¸€ä¸ªç‚¹ä½œä¸ºå®é™…ç»ˆç‚¹<br />
</li>
<li>Shuffling,Dropout,Gradient noise: è¿™äº›éƒ½æ˜¯å¢åŠ éšæœºæ€§çš„æ–¹æ³•</li>
<li>Warm-up,Curriculum learning(å…ˆå­¦å®¹æ˜“çš„æ•°æ®),Fine-tuning(ä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹)</li>
</ul>
<p>ç»éªŒä¸Š,cvç”¨sgdmå¤šä¸€ç‚¹;nlp,ganç”¨adamå¤šä¸€ç‚¹</p>
<h3 id="normalization">Normalization</h3>
<p>ä¸ºäº†å¤„ç†ä¸åŒç»´åº¦ä¸Šè¾“å…¥è§„æ¨¡ä¸ä¸€çš„é—®é¢˜,éœ€è¦å½’ä¸€åŒ–<br />
Feature Normalization: æˆ‘ä»¬æŠŠç»Ÿä¸€ç»´åº¦çš„xè¾“å…¥è§†ä¸ºæ­£æ€åˆ†å¸ƒçš„,ä»¤ <span class="math inline">\(\widetilde{x}_{i}^{r}\leftarrow{\frac{x_{i}^{r}-m_{i} }{\sigma_{i}} }\)</span> å…¶ä¸­mä¸ºå¹³å‡æ•°,ğœæ˜¯æ ‡å‡†å·®<br />
å½“ç„¶ä¹Ÿå¯ä»¥å¯¹ä¸wçš„åŠ æƒå’Œzå‘é‡åšå½’ä¸€åŒ–: <span class="math inline">\({\tilde{z}}^{i}=\frac{z^{i}-\mu}{\sigma}\)</span><br />
ç„¶åä»¤ <span class="math inline">\(z^{i}=\gamma\Theta\widetilde{z}^{i}+\beta\)</span> , å…¶ä¸­Î³åˆå§‹ä¸º1,Î²åˆå§‹ä¸º0,è¿™ä¸¤ä¸ªæ˜¯å­¦ä¹ å‚æ•°,ç”¨äºåœ¨ä¹‹åè°ƒæ•´åˆ†å¸ƒ<br />
è¿™æ ·çš„å½’ä¸€åŒ–è®¡ç®—é‡è¾ƒå¤§,å®é™…ä¸­ä¸€èˆ¬åªå¯¹batchåšå½’ä¸€åŒ–</p>
<p><img src="/assets/ml/Pasted%20image%2020250902150544.png" /></p>
<h2 id="å·ç§¯ç¥ç»ç½‘ç»œcnn">å·ç§¯ç¥ç»ç½‘ç»œCNN</h2>
<p>åè¯è§£é‡Š:</p>
<ul>
<li>Receptive Fieldï¼ˆæ„Ÿå—é‡ï¼‰: å­—é¢æ„æ€,å°±æ˜¯ç¥ç»å…ƒçš„è§†é‡,cvä¸­æˆ‘ä»¬å¸Œæœ›ç¥ç»å…ƒå„è‡ªåªæ•æ‰ä¸€ä¸ªå±€éƒ¨ç‰¹å¾,ä¸€èˆ¬æ„Ÿå—é‡ä¼šæ˜¯æ–¹å½¢çŸ©é˜µ
<ul>
<li>æœ€å¸¸è§çš„rfæ˜¯è¦†ç›–æ‰€æœ‰ç»´åº¦(channel)çš„,ä¹Ÿå°±æ˜¯æ‰€æœ‰è‰²å½©ç©ºé—´,å¸¸è§çš„rfæ˜¯3Ã—3,ä¸”ä¼šæœ‰å¤æ•°çš„ç¥ç»å…ƒ</li>
<li>å…±äº«å‚æ•°: å³ä¸¤ä¸ªç¥ç»å…ƒç”¨ç›¸åŒçš„å‚æ•°,å¸¸è§çš„å…±äº«æ–¹æ³•æ˜¯: æ¯ä¸ªrfæœ‰nç»„ç¥ç»å…ƒ,ä¸åŒçš„rfç›¸åŒç»„åºå·çš„ç¥ç»å…ƒå…±äº«å‚æ•°;ä¹Ÿå¯ä»¥ç†è§£ä¸ºç”¨ä¸åŒçš„filterçŸ©é˜µ(ä¹Ÿå°±æ˜¯å…±äº«å‚æ•°çš„ç¥ç»å…ƒ)åšå·ç§¯</li>
</ul></li>
<li>stride(æ­¥å¹…): æ„Ÿå—é‡ä¹‹é—´çš„æ­¥å¹…,ä¾‹å¦‚ä¸€ä¸ªrfå¯¹ä¸Šçš„æœ€å·¦ä¸Šå…ƒç´ æ˜¯(i,j),ä¸‹ä¸€ä¸ªå¯¹ä¸Šçš„å·¦ä¸Šå…ƒç´ å°±æ˜¯(stride+i,j)</li>
<li>padding: ç”±äºå†…æ ¸çŸ©é˜µä»¥åŠæ­¥å¹…æœªå¿…ä¼šè®©æœ€åä¸€æ­¥æ­£å¥½å¤Ÿè¿ç®—,æœ‰æ—¶éœ€è¦å¡«å……è‹¥å¹²è¡Œ/åˆ—,æœ€å¸¸ç”¨çš„æ˜¯ç›´æ¥å¡«0</li>
<li>pooling(æ± åŒ–): åœ¨ä¸æ”¹å˜å…³é”®ä¿¡æ¯çš„å‰æä¸‹å°½å¯èƒ½ç®€åŒ–è¾“å…¥è§„æ¨¡,ä¾‹å¦‚å¯¹è§„æ¨¡æ˜¯mÃ—mçš„çŸ©é˜µ,å¯¹æ¯ä¸ªnÃ—nçš„å­çŸ©é˜µå–ä¸€ä¸ªæœ€å¤§å€¼,æœ€åå¾—åˆ°è¾¹é•¿m/nçš„æ–¹é˜µ</li>
<li>flatten: å°†æœ€åçš„ç»“æœæ‹‰é•¿ä¸ºä¸€ç»´å‘é‡,ç”¨äºä¹‹åçš„æ¨¡å‹å­¦ä¹ </li>
</ul>
<p>åŸºäºä»¥ä¸Šé™åˆ¶,cnnçš„<code>model bias</code>å…¶å®ç›¸å¯¹è¾ƒå¤§,ä½†åœ¨å½±åƒè¾¨è¯†ä¸­ä¸æ˜¯åäº‹</p>
<h3 id="spatial-transformer-layer">spatial transformer layer</h3>
<p>é‰´äºCNNçš„ç‰¹ç‚¹,å®ƒå¯¹å›¾ç‰‡ç¼©æ”¾,æ—‹è½¬,é•œåƒåçš„æ•°æ®,ä¸ä¼šä¾æ—§ä¿æœ‰è¯†åˆ«èƒ½åŠ›.å½“ç„¶æƒ³å¤„ç†è¿™ä¸ªé—®é¢˜å¾ˆç®€å•,æŠŠç»è¿‡å˜åŒ–çš„å›¾ç‰‡ä¹Ÿå¡è¿›è®­ç»ƒé›†å°±å¯ä»¥äº†,ä½†æ˜¯è¿™æ ·ä¼šä¸¥é‡å½±å“è®­ç»ƒæ•ˆç‡,è€Œæ›´å¥½çš„åšæ³•æ˜¯,å¢åŠ ä¸€ä¸ªå›¾ç‰‡å˜åŒ–å±‚,ç”¨äºè½¬åŒ–å›¾ç‰‡åˆ°è®­ç»ƒé›†çš„å¯¹åº”æ•°æ®<br />
å¯¹å›¾ç‰‡çš„æ¯ä¸ªåƒç´ ,ä¸€ä¸ª2Ã—2çš„æƒé‡çŸ©é˜µåŠ ä¸€ä¸ª2ç»´çš„åç§»å‘é‡å°±å¯ä»¥å¾—å‡ºå…¶å¯¹åº”åƒç´ ,è€Œå¯¹äºéæ•´æ•°çš„å¯¹åº”åæ ‡,å‡ºäºå¯å¾®æ€§è€ƒè™‘,å°†å…¶ä¸å‘¨è¾¹ç‚¹çš„è·ç¦»ç§¯ä¸ºæƒå€¼ä¹˜ä»¥å‘¨è¾¹ç‚¹çš„å€¼,æœ€åç›¸åŠ ,å¦‚ä¸‹æ‰€ç¤º:<br />
<span class="math display">\[\begin{array}{l}{ {a_{22}^{l}=(1-0.4)\times(1-0.4)\times{}(1-0.4)\times a_{22}^{l-1} } }\\ { {+(1-0.6)\times(1-0.4)\times(1-0.6)\times a_{12}^{l-1} } }\\ { {+(1-0.6)\times(1-0.6)\times(1-0.6)\times a_{23}^{l-1} } } \\ { +(1-\,0.4)\times(1-0.6)\times a_{23}^{l-1} } \end{array}\]</span> ç”±äºè¿™æ ·çš„å–å€¼æ˜¯å¯å¾®çš„,ä¹Ÿå°±å¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™è¿›è¡Œå­¦ä¹ ,å°†å…¶åµŒå…¥ç¥ç»ç½‘ç»œä¸­åˆ™å¯æé«˜å¯¹å˜åŒ–åå›¾ç‰‡çš„è¯†åˆ«æ•ˆæœ</p>
<h2 id="self-attention">self-attention</h2>
<p>sequence labeling: å³ä¸ºè¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åˆ†é…ä¸€ä¸ªæ ‡ç­¾,ä¾‹å¦‚nlpä¸­æ ‡æ³¨è¯æ€§.è¿™ç§é—®é¢˜çš„éš¾ç‚¹åœ¨äº: ç”±äºè¾“å…¥çš„å‘é‡é•¿åº¦ä¸å®š,éš¾ä»¥ç¡®å®šåº”è¯¥ç”¨ä»€ä¹ˆè§„æ ¼çš„ç½‘ç»œ,äºæ˜¯éœ€è¦æ³¨æ„åŠ›è¿™ç§æœºåˆ¶æ¥è®©ä¸€ä¸ªè¾“å…¥å‘é‡aèƒ½è·å–ä¸€äº›åºåˆ—ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å½¢æˆå‘é‡bå†è¿›å…¥ç½‘ç»œ<br />
é‚£ä¹ˆæ€ä¹ˆè®©aæºå¸¦ä¸Šä¸‹æ–‡ä¿¡æ¯å‘¢,å¸¸è§çš„æ€è·¯æœ‰åšåŠ æƒå’Œ(additive)æˆ–è€…åŠ æƒç§¯(dot-product),åè€…æ›´å¸¸ç”¨,ä¹Ÿå°±æ˜¯è¾“å…¥å‘é‡å„ç§ä¹˜ä»¥ä¸€ä¸ª(äº’ä¸ç›¸åŒçš„)æƒé‡,ç„¶åä¹˜åœ¨ä¸€èµ·<br />
s-aå±‚æ‰€åšçš„è¿ç®—å¦‚ä¸‹å›¾:</p>
<p><img src="/assets/ml/Pasted%20image%2020250831171404.png" /></p>
<p>å®é™…ä¸Š,è¯¥å±‚å­¦ä¹ çš„å°±æ˜¯ä¸‰ä¸ªæƒå€¼çŸ©é˜µ</p>
<p>ç›¸å…³æŠ€æœ¯:</p>
<ul>
<li>Multi-head Self-attention: ç®€å•åœ°è¯´å°±æ˜¯ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›ç¥ç»,å…¶äº§ç‰©ç®—åŠ æƒå’Œä½œä¸ºæœ€ç»ˆè¾“å‡º</li>
<li>Positional Encoding: ä¸ºäº†å¼¥è¡¥æ³¨æ„åŠ›æ²¡æœ‰ä½ç½®ä¿¡æ¯çš„é—®é¢˜,æœ€æ—©çš„å¤„ç†æ˜¯å¯¹è¾“å…¥aiåŠ ä¸Šä¸€ä¸ªeiåç½®,åç»­å‘å±•ä¸­æœ‰ä¸åŒçš„æ·»åŠ ä½ç½®ä¿¡æ¯çš„æ–¹æ³•</li>
<li>Truncated Self-attention: å¯¹è¯­éŸ³è¿™ç§è§„æ¨¡å¾ˆå¤§çš„è¾“å…¥,å‡ºäºæ•ˆç‡è€ƒè™‘,å¯ä»¥å‡å°‘æ³¨æ„åŠ›è®¡ç®—çš„èŒƒå›´,åªçœ‹å¾ˆå°çš„ä¸Šä¸‹æ–‡</li>
<li>CNN: cnnå¯ä»¥è§†ä¸ºæ³¨æ„åŠ›çš„ä¸€ç§ç‰¹ä¾‹</li>
<li>RNN: ç›¸æ¯”rnn,æ³¨æ„åŠ›åœ¨å¹¶è¡Œæ€§,ä»¥åŠå¯¹ä¸Šä¸‹æ–‡ä¿¡æ¯çš„åˆ©ç”¨èƒ½åŠ›ä¸Šéƒ½ç›¸å¯¹æ›´å¥½</li>
</ul>
<h3 id="å˜å½¢é‡‘åˆš">å˜å½¢é‡‘åˆš</h3>
<p>transformer,ä¸‹æ–‡ç®€ç§°tf,æ˜¯ä¸€ç§seq2seqæ¨¡å‹,è¿™ç§æ¨¡å‹æœ‰ç›¸å½“å¹¿æ³›çš„åº”ç”¨,è¯­éŸ³è¾¨è¯†/åˆæˆ,å¥æ³•åˆ†æ,ç›®æ ‡æ£€æµ‹,ä»¥åŠç°åœ¨çƒ­é—¨çš„å¯¹è¯ç”Ÿæˆéƒ½å¯ä»¥ä½¿ç”¨</p>
<p><img src="/assets/ml/seq2seq_v9.png" /></p>
<p>tfçš„æ¶æ„ç›¸å½“å¤æ‚,è¿™é‡Œç®€å•åœ°æè¿°ä¸€ä¸‹:å…¶ä¸»è¦ç”¨en/decoderç»„æˆ,encoderä¸­æœ‰å¾ˆå¤š<code>block</code>ç”¨äºç”Ÿæˆä¸­é—´å‘é‡,æ¯å±‚<code>block</code>å…ˆåšä¸€æ¬¡æ³¨æ„åŠ›(ç»“æœå‘é‡åŠ ä¸Šè¾“å…¥å‘é‡,è¿™å«åš<code>residual connection</code>,éšååšä¸€æ¬¡<code>layer normalization</code>),å†ç”¨å…¨è¿æ¥(fc)ç½‘ç»œè®¡ç®—,è¿™ä¸ªfcç½‘ç»œä¹Ÿä¼šç”¨<code>residual</code><br />
<code>decoder</code>é™¤äº†æ¥å—<code>encoder</code>æ•°æ®å¤–,è¿˜è¦æ¥å—ä¸€ä¸ªè¡¨ç¤ºå¼€å§‹äº§ç”Ÿè¾“å‡ºçš„ç¬¦å·(bos),è¿™ä¸ªç¬¦å·å¯ä»¥ç”¨one-hotè¡¨ç¤º,ç±»ä¼¼rnn,decä¸æ–­æŠŠè‡ªå·±çš„è¾“å‡ºå½“åšä¸‹ä¸€è½®çš„è¾“å…¥,å¦‚æœè¾“å‡ºä¸€ä¸ªç»ˆæ­¢ç¬¦æ¥ç»“æŸ,å°±å«<code>Autoregressive</code>;è€Œ<code>Non-autoregressive</code>åˆ™ä¸€æ¬¡ç”Ÿæˆæ‰€æœ‰è¾“å‡º,ä¸€ä¸ªè¾“å…¥å¯¹åº”ä¸€ä¸ªè¾“å‡º,ä¸ºæ­¤éœ€è¦ä¸€ä¸ªåˆ†ç±»å™¨æ¥äº§ç”Ÿé•¿æˆ–è€…ä¸€ä¸ªè¶³å¤Ÿé•¿çš„é»˜è®¤é•¿åº¦,è®©æœºå™¨è‡ªå·±é€‰ä¸€ä¸ªæ§½ä½è¾“å‡ºç»ˆæ­¢ç¬¦,è¿™æ ·çš„å¥½å¤„æ˜¯å¹¶è¡ŒåŒ–ä¸”å®¹æ˜“æ§åˆ¶é•¿åº¦,ç¼ºç‚¹åˆ™æ˜¯è¡¨ç°å·®<br />
å…³äºdecçš„æ¶æ„,è§‚å¯Ÿå…¶ä¸encä¸åŒ,é¦–å…ˆæ˜¯æ³¨æ„åŠ›å±‚å¤šäº†maskedå‰ç¼€,è¿™ä¸ªæ©ç å°±æ˜¯è®©æ‰€æœ‰è¾“å…¥ç»´åº¦çš„æ³¨æ„åŠ›åªèƒ½æ³¨æ„è‡ªå·±æå…¶ä»¥å‰çš„è¾“å…¥(ç”±äºdecoderè¾“å‡ºæœ‰é¡ºåº,è¿™æ ·å¾ˆç¬¦åˆç›´è§‰)<br />
å…³äºä¸¤è€…çš„äº¤äº’,çœ‹ä¸‹é¢çš„å›¾æ¯”è¾ƒç›´è§‚,ä¸å¤ªå‡†ç¡®çš„è¯´å°±æ˜¯åŒæ—¶ç”¨åŒæ–¹çš„æ•°æ®ä¸æ–­åœ°åšmasked æ³¨æ„åŠ›(è¾“å‡ºä¼šä¸æ–­ä½œä¸ºä¸‹ä¸€è½®è¾“å…¥åŠ è¿›æ¥),è¿™å«åš<code>Cross Attention</code><br />
åŸå§‹è®ºæ–‡ä¸­decä¸æ–­ä»encçš„æœ€åä¸€å±‚æ‹¿æ•°æ®,ä½†ä¹Ÿæœ‰è®ºæ–‡ä¼šå¯¹åº”ç€æ‹¿<br />
<img src="/assets/ml/seq2seq_v9_1.png" /></p>
<p>ç›¸å…³æŠ€æœ¯:</p>
<ul>
<li>Teacher Forcing: ç®€å•åœ°è¯´å°±æ˜¯è®­ç»ƒæ—¶ç›´æ¥å°†ç­”æ¡ˆä½œä¸ºdecè¾“å…¥</li>
<li>Copy Mechanism: ä»è¾“å…¥ä¸­å¤åˆ¶æ–‡å­—ç»™è¾“å‡ºç”¨çš„èƒ½åŠ›</li>
<li>Guided Attention: å¯¹ä¸€äº›è§„åˆ™ä¸¥æ ¼çš„åœºæ™¯,å¯ä»¥ç›´æ¥å¯¹è®­ç»ƒä¸­çš„æ¨¡å‹åŠ ä»¥é™åˆ¶,ä¾‹å¦‚è¯­éŸ³åˆæˆ</li>
<li>Beam Search: ä¸€ç§å¸¸ç”¨äºåºåˆ—é¢„æµ‹ä»»åŠ¡çš„æœç´¢ç®—æ³•,èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¢„æµ‹ç›¸å¯¹æ›´ä¼˜çš„åºåˆ—/è·¯å¾„</li>
<li>exposure bias: decè¾¨è¯†é”™è¯¯çš„èƒ½åŠ›å·®,å¯¼è‡´ä¸€æ­¥é”™æ­¥æ­¥é”™,è§£å†³æ–¹æ³•æ˜¯å¢åŠ ä¸€äº›Noise</li>
<li>Scheduled Sampling: åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­,é€æ­¥å‡å°ä½¿ç”¨çœŸå®ç›®æ ‡åºåˆ—çš„æ¦‚ç‡</li>
</ul>
<h3 id="bert">bert</h3>
<p>bert,ç›®å‰å¾ˆç«çš„é¢„è®­ç»ƒseq2seqæ¨¡å‹,æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ æ¨¡å‹,ä¹Ÿå°±æ˜¯æ²¡æœ‰labelæ•°æ®,å…¶ç‰¹ç‚¹æ˜¯è®­ç»ƒä¸­ä½¿ç”¨æ©ç æ•°æ®(Masking Input),ä¹Ÿå°±æ˜¯é®ä½è¾“å…¥çš„éƒ¨åˆ†å­—è¯,è€ŒåŠ ä¸Šé®ä½æ•°æ®çš„å®Œæ•´è¾“å…¥å°±æ˜¯æˆ‘ä»¬å¸Œæœ›bertèƒ½è¾“å‡ºçš„ç»“æœ,è€ŒæŸå¤±å‡½æ•°ä¹Ÿå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°ç”¨äº¤å‰ç†µ(å¯ä»¥ç†è§£ä¸ºä»¥æ‰€æœ‰å­—ç¬¦ä¸ºç±»åˆ«çš„åˆ†ç±»é—®é¢˜)<br />
bertæ˜¯åŸºäºtfçš„,å…¶æ¶æ„å’Œtfç±»ä¼¼,åŒºåˆ«å°±æ˜¯ç”¨æ©ç æœºåˆ¶æ¥æ— ç›‘ç£å­¦ä¹ ,ç”±äºä¸éœ€è¦æ ‡æ³¨çš„æ•°æ®é›†,bertå¾ˆå®¹æ˜“å¾—åˆ°è§„æ¨¡éå¸¸åºå¤§çš„æ•°æ®,å› æ­¤æœ‰ç€å¾ˆå¥½çš„è¡¨ç° é™¤æ­¤ä»¥å¤–æœ‰ä¸€äº›å…¶ä»–è®­ç»ƒæ–¹æ³•,å¦‚Next Sentence Prediction: é¢„æµ‹ä¸¤ä¸ªå¥å­æ˜¯å¦ç›¸æ¥;Sentence order prediction:åˆ¤æ–­å¥å­çš„é¡ºåºå…³ç³»<br />
åœ¨ä»¥ä¸‹è¿™äº›å¸¸è§çš„ä¸€äº›åŸºå‡†æµ‹è¯•ä¸­,bertéƒ½æœ‰ä¸ä¿—çš„è¡¨ç°:</p>
<ul>
<li>Corpus of Linguistic Acceptability (CoLA)</li>
<li>Stanford Sentiment Treebank (SST-2)</li>
<li>Microsoft Research Paraphrase Corpus (MRPC)</li>
<li>Quora Question Pairs (QQP)</li>
<li>Semantic Textual Similarity Benchmark (STS-B)</li>
<li>Multi-Genre Natural Language Inference (MNLI)</li>
<li>Question-answering NLI (QNLI)</li>
<li>Recognizing Textual Entailment (RTE)</li>
<li>Winograd NLI (WNLI)</li>
</ul>
<p>å°½ç®¡ BERT çš„é¢„è®­ç»ƒæ˜¯æ— ç›‘ç£çš„ï¼Œä½†åœ¨ç‰¹å®šä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬åˆ†ç±»ã€è¯­æ³•åˆ†æç­‰ï¼‰ä¸­(å¯¹è¿™äº›ä¸‹æ¸¸ä»»åŠ¡æ¥è¯´,å¯ä»¥ç®€å•åœ°ç»™bertæ¥ä¸Šåˆ†ç±»æˆ–è€…çº¿æ€§æ¨¡å‹)ï¼ŒBERT å¯ä»¥è¿›è¡Œå¾®è°ƒ,è¿™ä¸ªè¿‡ç¨‹æ˜¯ç›‘ç£å­¦ä¹ ã€‚å¾®è°ƒé˜¶æ®µä½¿ç”¨æ ‡æ³¨å¥½çš„æ•°æ®é›†ï¼Œé€šè¿‡å·²çŸ¥çš„æ ‡ç­¾æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°.æ‰€ä»¥å¦‚æœæƒ³å‡†ç¡®ä¸€ç‚¹,å¯ä»¥å«åŠç›‘ç£å­¦ä¹ (semi)<br />
bertçš„ä¼˜å¼‚æ€§èƒ½å¸¸å¸¸è¢«å½’å› äºæ³¨æ„åŠ›å¯¹ä¸Šä¸‹æ–‡çš„æ•è·èƒ½åŠ›ä»¥åŠå¤§é‡çš„è®­ç»ƒèµ„æ–™,ä½†ç¥å¥‡çš„æ˜¯ç”¨äºåšè›‹ç™½è´¨åˆ†ç±»æ•ˆæœä¹Ÿå¾ˆå¥½,è‹±è¯­Bertç”¨åœ¨ä¸­æ–‡ä¸Šæ•ˆæœä¹Ÿå¾ˆå¥½,è¿™æˆ–è®¸å¯ä»¥ç†è§£ä¸ºè¿™äº›æœ‰è§„å¾‹çš„ç¼–ç ä½œä¸ºè¯­è¨€å…¶å®åœ¨è¯ä¹‰å‘é‡ä»¥åŠç»“æ„ä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„,æ ¹æ®æè€å¸ˆè‡ªå·±çš„å®éªŒ,è¿™ç§ç¥å¥‡çš„èƒ½åŠ›åªä¼šå‡ºç°åœ¨è¶³å¤Ÿå¤§çš„è®­ç»ƒé›†ä¸Š</p>
<h2 id="rnn">RNN</h2>
<p>ç›¸å…³åœºæ™¯:</p>
<p>slot filling: ç±»ä¼¼ä¸€ä¸ªåˆ†ç±»é—®é¢˜,å°†ç»™å®šè¾“å…¥å‘é‡(ä¸€å¥è¯)ä¸­çš„è¯è¯­åˆ†ç±»åˆ°ç‰¹å®šçš„æ§½ä½å»</p>
<p>rnnç”¨äºè§£å†³è¾“å…¥å‘é‡é—´æœ‰é¡ºåºå…³ç³»çš„é—®é¢˜,æ™®é€šçš„å‰é¦ˆç½‘ç»œæ‰€æœ‰è¾“å…¥çš„è¯è¯­éƒ½æ˜¯åœ°ä½ç›¸åŒçš„,å› æ­¤å¾ˆéš¾æ•æ‰æ–‡å­—çš„å‰åè¯­ä¹‰å…³ç³»,äºæ˜¯äº§ç”Ÿäº†rnnè¿™ç§æ–¹æ³•,ä¹Ÿå°±æ˜¯æŠŠå‰é¢çš„è®¡ç®—ç»“æœä½œä¸ºä¹‹åçš„è¾“å…¥,å¸¸è§çš„ç±»å‹æœ‰:</p>
<ul>
<li>ç®€å•rnn
<ul>
<li>elman network: å…ˆå‰çš„éšè—å±‚è®¡ç®—ç»“æœå­˜èµ·æ¥,åé¢è¢«ä¸‹ä¸€ä¸ªç¥ç»å…ƒçš„éšè—å±‚è°ƒç”¨</li>
<li>jordan network: å°†å‰ä¸€ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå­˜èµ·æ¥,è¢«ä¸‹ä¸€ä¸ªç¥ç»å…ƒè°ƒç”¨</li>
</ul></li>
<li>å…¶ä»–
<ul>
<li>Bidirectional RNN: è®­ç»ƒæ­£å‘å’Œåå‘çš„ä¸¤ä¸ªrnn,æœ€åçš„è¾“å‡ºç®—åŠ æƒå’Œ</li>
</ul></li>
</ul>
<h3 id="long-short-term-memory-lstm">Long Short-term Memory (LSTM)</h3>
<p>ç®€å•åœ°è¯´å°±æ˜¯ç”¨ä¸¤ä¸ªé˜€é—¨æ§åˆ¶æ˜¯å¦å­˜å…¥æˆ–æ”¾å‡ºå†å²ä¿¡æ¯,ä¸€ä¸ªé˜€é—¨æ§åˆ¶æ˜¯å¦é—å¿˜å·²æœ‰çš„ä¿¡æ¯,é˜€é—¨çš„å¼€é—­è®©ç½‘ç»œå­¦ä¹ <br />
å…¶è®­ç»ƒè¿‡ç¨‹ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç¹ç,è¿˜å¥½æè€å¸ˆç»†å¿ƒåœ°åšäº†æµç¨‹å›¾,è¿™é‡Œç›´æ¥è´´ä¸Šæ¥</p>
<div class="pdf-container" data-target="/assets/ml/RNN.pdf" data-height="800px"></div>
<p>LSTMçš„ç¼ºç‚¹æ˜¯è¿‡äºå¤æ‚å¯¼è‡´è®¡ç®—æˆæœ¬é«˜,å› æ­¤æœ‰Gated Recurrent Unit (GRU)è¿™æ ·çš„ç®€åŒ–ç‰ˆæœ¬(ä¸‰ä¸ªgate)</p>
<h3 id="é—®é¢˜">é—®é¢˜</h3>
<ol type="1">
<li><p>RNNä¼šå¤ç”¨ä¹‹å‰çš„æ¨¡å‹,ä¾‹å¦‚å…¶æƒå€¼w,è¿™ä¼šå¯¼è‡´å±‚æ•°ä¸Šæ¥å,åé¢ç¥ç»çš„æƒå€¼ä¼šäº§ç”Ÿå¹‚å‡½æ•°å…³ç³»,ä½¿loss surfaceéå¸¸é™¡å³­<br />
æ›´å‡†ç¡®åœ°è¯´,ç”±äºå¹‚å‡½æ•°çš„ç‰¹æ€§,wå°ä¼šå¾ˆå®¹æ˜“æ¢¯åº¦æ¶ˆå¤±,wå¤§åˆ™éå¸¸é™¡å³­,LSTMå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šè§£å†³å‰ä¸€ä¸ªé—®é¢˜,å› ä¸ºå®ƒèƒ½å­˜å‚¨å†å²ä¿¡æ¯æ›´é•¿æ—¶é—´<br />
è€Œåä¸€ä¸ªé—®é¢˜,å·¥ç¨‹ä¸Šæœ€å®ç”¨çš„æ–¹æ³•æ˜¯clipè®¾ç½®ä¸Šç•Œ</p></li>
<li><p>é‰´äºrnnçš„ç‰¹æ€§,å¤„ç†ä¸å®šé•¿çš„è¾“å…¥(å‘é‡)æ˜¯å¾ˆæ–¹ä¾¿çš„,ä½†å¦‚ä½•å¤„ç†ä¸å®šé•¿çš„è¾“å‡ºå‘¢?<br />
ä¾‹å¦‚è¯­éŸ³è¯†åˆ«,å¯¹è‹¥å¹²éŸ³é¢‘è¾“å…¥,ç®€å•çš„æƒ³æ³•æ˜¯æ¯ä¸ªéŸ³é¢‘è¾“å‡ºä¸€ä¸ªå­—ç¬¦,ç»“æœæŠŠæ¯ä¸ªè¾“å‡ºçš„é‡å¤éƒ¨åˆ†æ‹¿æ‰,ä½†å¦‚ä½•å¤„ç†å è¯å‘¢?<br />
å¯ä»¥ç”¨ä¸€ä¸ªÏ†ç¬¦å·ä»£è¡¨null,ä¹Ÿå°±æ˜¯åˆ†å‰²ç¬¦,Ï†é—´çš„æœ‰æ„ä¹‰è¾“å‡ºä½œä¸ºè¯†åˆ«ç»“æœ,ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯,éŸ³é¢‘å¯èƒ½åˆ‡çš„å¾ˆç¢,ä¸èƒ½ä¿è¯å¯¹åº”å…³ç³»å…·ä½“åº”è¯¥æ€ä¹ˆæ’<br />
ä¸ºæ­¤éœ€è¦<code>Connectionist Temporal Classification (CTC)</code>ç®€å•åœ°è¯´å°±æ˜¯ç©·ä¸¾å¯èƒ½çš„æ’åˆ—(å®é™…ä¼šç”¨dpä¼˜åŒ–),é€‰å–å…¶ä¸­æœ€å¤šçš„ä¸€ç§(å³æ¦‚ç‡æœ€å¤§çš„æ’åˆ—/å¯¹åº”å…³ç³»)</p></li>
</ol>
<p>ä»¥ä¸Šè®¨è®ºçš„è¯­éŸ³è¯†åˆ«å…¶å®æœ‰ä¸€ä¸ªé¢„è®¾--è¯†åˆ«ç»“æœçš„å­—ç¬¦æ•°â‰¤éŸ³é¢‘æ ·æœ¬æ•°,å¯¹æ²¡æœ‰è¿™ç§æ¡ä»¶çš„é—®é¢˜,ä¾‹å¦‚æœºå™¨ç¿»è¯‘è¯¥æ€ä¹ˆåšå‘¢?<br />
ç”±äºæ˜¯å¾ªç¯çš„,rnnå¯ä»¥ä¸æ–­åœ°äº§ç”Ÿè¾“å‡º,åªéœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„è¡¨ç¤ºç»“æŸçš„ç¬¦å·å°±å¯ä»¥,ä¾‹å¦‚<code>===</code></p>
<h2 id="æ·±åº¦å­¦ä¹ ">æ·±åº¦å­¦ä¹ </h2>
<p>Q: ä¸ºä»€ä¹ˆè¦æ·±åº¦,ä¸ºä»€ä¹ˆè¦ç”¨é‚£ä¹ˆå¤šéšè—å±‚è€Œä¸æ˜¯ä¸€ä¸ªå¾ˆå®½çš„å•å±‚ç½‘ç»œ?<br />
A: æ·±åº¦å­¦ä¹ èƒ½å¢åŠ é¢„æµ‹å‡½æ•°çš„å¼¹æ€§,è¿™æ˜¯å› ä¸ºå®ƒå¯ä»¥å¤æ‚çš„ä¸åŒçº¿æ€§å…³ç³»å»æ‹Ÿåˆæ•°æ®,é‚£ä¹ˆä¸ºä»€ä¹ˆè¦ç”¨å¾ˆæ·±çš„ç½‘ç»œ?å®é™…ä¸Š,ç›¸åŒç¥ç»æ•°é‡ä¸”è¾ƒæµ…çš„ç½‘ç»œé¢„æµ‹æ•ˆæœä¼šä¸å¦‚dl,ä¹Ÿå°±æ˜¯dlèƒ½ç”¨ç›¸å¯¹æ›´å°‘çš„å‚æ•°æ‹Ÿåˆæ•°æ®,å› æ­¤æ›´ä¸å®¹æ˜“overfitting,æœ‰æ›´å¥½çš„å‡†ç¡®ç‡;è€Œdlçš„è¿™ç§é«˜æ•ˆå…¶å®ç±»ä¼¼ç¼–ç¨‹ä¸­çš„ä¾èµ–å…³ç³»,ä¾‹å¦‚æŸä¸ªèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹éƒ½å¯ä»¥ä¾èµ–äºå‰ä¸€ä¸ªèŠ‚ç‚¹,è€Œæ•´æ®µç¨‹åºåªéœ€è¦ä¿ç•™è¿™ä¸ªè¢«å¤šé‡ä¾èµ–çš„èŠ‚ç‚¹çš„ä¸€ä¸ªå‰¯æœ¬,èŠ‚çœå¤§é‡ç©ºé—´,dlä¸­å…¶å®ä¹Ÿå¯èƒ½å­˜åœ¨å¯¹æŸä¸ªå‰ç»§ç¥ç»çš„ä¾èµ–å…³ç³»,ä¹Ÿå°±æ˜¯dlæ˜¯ä¸€ä¸ªæœ‰ç»“æ„ä¸Šå…³ç³»çš„ç½‘ç»œ</p>
<h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3>
<p>å¯¹äºå¤æ‚çš„ç½‘ç»œ,ä¼šä½¿ç”¨ç¥ç»ç½‘ç»œå—(block)æ¥æè¿°è‹¥å¹²ä¸ªç½‘ç»œå±‚çš„ç»„åˆ,ä¸€èˆ¬æ¥è¯´,å—æœ‰è‡ªå·±çš„å‚æ•°,å‰å‘ä¼ æ’­,åå‘ä¼ æ’­å‡½æ•°,è¿™æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µ,torchä¸­å¯ä»¥ç”¨æ¨¡å—æˆ–è€…seqæ¥å®ç°</p>
<div class="note info"><ul>
<li><code>torch.nn.Module</code>: Base class for all neural network modules.Your models should also subclass this class.å³æ‰€æœ‰æ¨¡å‹çš„åŸºç±»</li>
<li><code>torch.nn.Sequential</code>: Modules will be added to it in the order they are passed in the constructor. æœ‰é¡ºåºçš„<code>module</code>çš„å®¹å™¨,ä¸<code>ModuleList</code>çš„æ˜¯å®ƒæä¾›å¯¹å†…ç½®æ¨¡å—çš„é¡ºåºè°ƒç”¨,ä¹Ÿå°±æ˜¯å·²ç»å®ç°äº†å‰å‘ä¼ æ’­,å› æ­¤å®ƒå¾ˆé€‚åˆç”¨æ¥å®šä¹‰ä¸€ä¸ªblock</li>
<li><code>torch.nn.ModuleList</code>:Holds submodules in a list. æ¨¡å—çš„list,å’Œæ™®é€šçš„listæ²¡ä»€ä¹ˆåŒºåˆ«,æœ‰ç´¢å¼•é¡ºåº,ä½†å¹¶æ²¡æœ‰é€»è¾‘ä¸Šçš„é¡ºåº</li>
</ul>
</div>
<div class="note info">
</div>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> è¯¾ç¨‹ç¬”è®°</a>
              <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
              <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag"><i class="fa fa-tag"></i> äººå·¥æ™ºèƒ½</a>
              <a href="/tags/%E5%9B%BD%E7%AB%8B%E5%8F%B0%E6%B9%BE%E5%A4%A7%E5%AD%A6/" rel="tag"><i class="fa fa-tag"></i> å›½ç«‹å°æ¹¾å¤§å­¦</a>
              <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> æœºå™¨å­¦ä¹ </a>
          </div>

        
  <div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style">
    <a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a>
      <a class="a2a_button_facebook"></a>
      <a class="a2a_button_twitter"></a>
      <a class="a2a_button_wechat"></a>
      <a class="a2a_button_qzone"></a>
  </div>

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/thinklive/16959/" rel="prev" title="åŸºäºå“ˆä½›cs50çš„è®¡ç®—æœºé€šè¯†ç¬”è®°">
                  <i class="fa fa-angle-left"></i> åŸºäºå“ˆä½›cs50çš„è®¡ç®—æœºé€šè¯†ç¬”è®°
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/thinklive/37185/" rel="next" title="å¼ºåŒ–å­¦ä¹ ç¬”è®° all in one">
                  å¼ºåŒ–å­¦ä¹ ç¬”è®° all in one <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2023 â€“ 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">thinklive</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">595k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">36:05</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> æŠ€æœ¯æ”¯æŒ
  </div><script defer src="/lib/three.js"></script><script defer src="/lib/lines.js"></script><script defer src="/lib/waves.js"></script>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.umd.js" integrity="sha256-oyhjPiYRWGXaAt+ny/mTMWOnN1GBoZDUQnzzgC7FRI4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>


  <script src=""></script>
  <script src="/%5Bobject%20Object%5D"></script>
  <script src="/%5Bobject%20Object%5D"></script>
  <script src="/%5Bobject%20Object%5D"></script>
  <script src="/%5Bobject%20Object%5D"></script>


<script>
var options = {
  bottom: '64px', // default: '32px'
  right: 'unset', // default: '32px'
  left: '32px', // default: 'unset'
  time: '0.5s', // default: '0.3s'
  mixColor: '#fff', // default: '#fff'
  backgroundColor: '#fff',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: true, // default: true,
  label: 'ğŸŒ“', // default: ''
  autoMatchOsTheme: true // default: true
}
const darkmode = new Darkmode(options);
darkmode.showWidget();
</script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>


  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.3.0/wavedrom.min.js","integrity":"sha256-IRMDzTC+wK5stMucZ/XSXkeS5VNtxZ+/Bm8Mcqfoxdo="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.3.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>

  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>

  <script src="/js/third-party/addtoany.js"></script>

  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":false,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://thinklive1.github.io/thinklive/48061/"}</script>
  <script src="/js/third-party/quicklink.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"thinklive1/blog_comments","issue_term":"pathname","theme":"photon-dark"}</script>
<script src="/js/third-party/comments/utterances.js"></script>
<script>
    const snowflakes = ["â„", "â„", "â†", "â…", "âœ¥","â„", "â„", "â†", "â…", "âœ¥","âœ»"];
    // åˆ›å»ºé›ªèŠ±
    function createSnowflake() {
        const snowflake = document.createElement("span");
        snowflake.classList.add("snowflake");
        const randomIndex = Math.floor(Math.random() * snowflakes.length);
        snowflake.textContent = snowflakes[randomIndex];
        
        // èµ·å§‹ä½ç½®
        /* 80%æ¦‚ç‡ ç”Ÿæˆåœ¨é¡µé¢ä¸¤ä¾§ 30% çš„ä½ç½®
        const probability = Math.random();
        let startPosition = Math.random() * 100;

        if (probability < 0.8) {
            startPosition = Math.random() < 0.5 ? Math.random() * 30 : (Math.random() * 30) + 70;
        }
        snowflake.style.left = `${startPosition}vw`;
        */
        snowflake.style.left = `${Math.random() * 100}vw`;
        snowflake.style.top = `-30px`;
        // é›ªèŠ±å¤§å°ä¸é€æ˜åº¦
        const size = Math.random() * 18 + 10;
        snowflake.style.fontSize = `${size}px`;
        const opacity = Math.random() * 0.6 + (size > 18 ? 0.4 : 0);
        snowflake.style.setProperty("--opacity", opacity);
        // åŠ¨ç”»æŒç»­æ—¶é—´
        const fallDuration = Math.random() * 10 + 10;
        // æ—‹è½¬æŒç»­æ—¶é—´
        const rotateDuration = Math.random() * 3 + 1;

        snowflake.style.animationDuration = `${fallDuration}s, ${fallDuration}s`; // å‘ CSS æ·»åŠ æ·¡å‡ºåŠ¨ç”»çš„æŒç»­æ—¶é—´
        // æ¨ªå‘å¹…åº¦
        const translateX = (Math.random() * 500 - 200);
        snowflake.style.setProperty("--translateX", `${translateX}px`);
        // çºµå‘å¹…åº¦
        snowflake.style.setProperty("--translateY", `${window.innerHeight}px`);

        document.body.appendChild(snowflake);
        // ç§»é™¤é›ªèŠ±
        setTimeout(() => {
            snowflake.remove();
        }, fallDuration * 1000);
    }
    
    function snowfallAnimation() {
        // è½½å…¥æ—¶è‹¥è¾¹æ æ˜¯éšè—çŠ¶æ€åˆ™ä¸åŠ è½½é›ªèŠ±
        const sidebarnav = document.querySelector('.sidebar');
        const sidebarnavdisplay = window.getComputedStyle(sidebarnav).getPropertyValue('display'); 
        if (sidebarnavdisplay !== 'none') {
            createSnowflake();
        }
        setTimeout(snowfallAnimation, 150); // ç”Ÿæˆé€Ÿåº¦ï¼Œæ¯«ç§’
    }
    snowfallAnimation();
function toggleMode() {
    console.log("change color!");
    const root1 = document.documentElement;

    // æ£€æŸ¥å½“å‰ color-scheme
    const isLightMode = getComputedStyle(root1).getPropertyValue('--content-bg-color').trim() === '#fff';

    if (isLightMode) {
        // åˆ‡æ¢åˆ°æš—æ¨¡å¼
        root1.style.setProperty('--content-bg-color', '#000');
        root1.style.setProperty('--text-color', '#fff');
        root1.style.setProperty('--highlight-background', '#444');
        root1.style.setProperty('--highlight-foreground', '#bbb');
        root1.style.setProperty('--btn-default-bg', '#777');
        root1.style.setProperty('--menu-item-bg-color', '#777');
        root1.style.setProperty('--note-warning-bg-color', '#777');
        root1.style.setProperty('--note-bg-color', '#555');
        root1.style.setProperty('--note-info-bg-color', '#777');
        root1.style.setProperty('--table-row-odd-bg-color', '#777');
        root1.style.transition = 'all 0.5s ease';

    }

    else {
        root1.style.setProperty('--content-bg-color', '#fff');
        root1.style.setProperty('--text-color', '#555');
        root1.style.setProperty('--highlight-background', '#eaeef3');
        root1.style.setProperty('--highlight-foreground', '#00193a');
        root1.style.setProperty('--btn-default-bg', '#fff');
        root1.style.setProperty('--menu-item-bg-color', '#f5f5f5');
        root1.style.setProperty('--note-warning-bg-color', '#fdf8ea');
        root1.style.setProperty('--note-bg-color', '#f9f9f9');
        root1.style.setProperty('--note-info-bg-color', '#eef7fa');
        root1.style.setProperty('--table-row-odd-bg-color', '#f9f9f9');
        root1.style.transition = 'all 0.5s ease';
    }
}

function DarkTrigger() {
    console.log('dark!!')
    let isDarkMode = getComputedStyle(document.documentElement).getPropertyValue('--content-bg-color').trim() === '#000';
    console.log(isDarkMode)
    if (isDarkMode) {
        // åˆ‡æ¢åˆ°æš—æ¨¡å¼
        const warningNotes = document.querySelectorAll('.post-body .note.warning');
        // ä¿®æ”¹èƒŒæ™¯é¢œè‰²
        warningNotes.forEach(note => {
        note.style.background = '#666';
        });

        const infoNotes = document.querySelectorAll('.post-body .note.info');
        // ä¿®æ”¹èƒŒæ™¯é¢œè‰²
        infoNotes.forEach(note => {
        note.style.background = '#666';
        });
    }
}


</script>

 <!--js: çº¿æ¡ç‰¹æ•ˆ-->
  <script type="text/javascript" color="255,255,255" opacity='1' zIndex="-1" count="300" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

<button style="background: #868686;
  width: 3rem;
  height: 3rem;
  position: fixed;
  border-radius: 50%;
  border: none;
  right: unset;
  bottom: 2rem;
  left: 2rem;
  cursor: pointer;
  transition: all 0.5s ease;
  display: flex;
  justify-content: center;
  align-items: center;" class="darkmode-toggle" role="checkbox" onclick="toggleMode()">ğŸŒ“</button>

  <video autoplay loop muted playsinline style="position:fixed;top:50%;opacity: 0.8;left:50%;min-width:100%;min-height:100%;transform:translateX(-50%)translateY(-50%);z-index:-2;">
  <source src="/images/red.mp4" type="video/mp4">
<!-- hexo injector body_end start --><script src="/assets/mmedia/mmedia-loader.js"></script><!-- hexo injector body_end end --></body>
</html>
